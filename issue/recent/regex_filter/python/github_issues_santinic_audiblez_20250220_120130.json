[
  {
    "number": 59,
    "title": "pip modules missing from doc",
    "created_at": "2025-02-11T23:55:40Z",
    "closed_at": "2025-02-12T14:12:07Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/santinic/audiblez/issues/59",
    "body": "Your software is great, thank you !\n\nBut in order to install it on a docker file I had to install the following pip packages :\n\nmarkdown tabulate num2words phonemizer espeakng_loader\n\nThis probably should be somewhere in the documentation as on bare systems (python 3.9) they do not seem to be installer by default.",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/59/comments",
    "author": "G-Cyrille",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-02-12T08:34:16Z",
        "body": "These dependencies are in the poetry.lock file, so they should be installed. How did you install?\n\nIf you install from sources, you should run `poetry install`"
      },
      {
        "user": "G-Cyrille",
        "created_at": "2025-02-12T14:12:07Z",
        "body": "I use pip install:\n\n`pip install --no-cache-dir audiblez`\n\nBut the usage of python 3.10 (from the other ticket) also closes this ticket as I was not able to reproduce with this python version.\nJust maybe something to be aware of if the issue comes back.\n\nAnyway, thank you for looking into this !"
      }
    ]
  },
  {
    "number": 53,
    "title": "Can the latest version of Audiblez convert Simplified Chinese e-books in EPUB format to audio? I might have discovered a bug.",
    "created_at": "2025-02-08T14:42:53Z",
    "closed_at": "2025-02-11T09:46:55Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/53",
    "body": "My system is macOS 15. After successfully installing Audiblez, I downloaded two EPUB format e-books. One is in English, and the other is in Chinese. When I used the command `audiblez en-book.epub -v af_sky` to generate English audio, there were no issues, and the English audio was successfully produced. However, when I used the command `audiblez cn-book.epub -v zf_xiaoxiao` to generate Chinese audio, Python reported an error. Please refer to the attached Python console log for the specific error details.\n\nThe following is the detailed error message:\n\n(radio_os_env) zhoubo@192 book % audiblez smallbook.epub -v zf_xiaoxiao\n/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/ebooklib/epub.py:1395: UserWarning: In the future version we will turn default option ignore_ncx to True.\n  warnings.warn('In the future version we will turn default option ignore_ncx to True.')\n/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/ebooklib/epub.py:1423: FutureWarning: This search incorrectly ignores the root element, and will be fixed in a future version.  If you rely on the current behaviour, change it to './/xmlns:rootfile[@media-type]'\n  for root_file in tree.findall('//xmlns:rootfile[@media-type]', namespaces={'xmlns': NAMESPACES['CONTAINERNS']}):\nFound cover image cover.jpeg in image/jpeg format\n空山横：讲演集，关于文学关于人 – 李敬泽.\n\n\n  #  Chapter               Text Length  Selected    First words\n---  ------------------  -------------  ----------  ---------------------\n  1  titlepage.xhtml                 0\n  2  text/part0000.html              0\n  3  text/part0001.html            131  ✅           版权信息 COPYRIGHT 书名：空山…\n  4  text/part0002.html           4896  ✅           跑步、文学、鹅掌楸（1） 在《南方周末》…\n  5  text/part0003.html           3326  ✅           隔与不隔，如果杜甫有手机（2） 在腾云峰…\n  6  text/part0004.html           8006  ✅           北京雨燕以及行者（3） 对理想作家的比喻…\n  7  text/part0005.html           2819  ✅           做一个满怀敬畏的“述者”（4） 在“凤凰…\n  8  text/part0006.html           6649  ✅           语言主权与作者的死亡（5） 关于超级AI…\n  9  text/part0007.html           2537  ✅           作为哪吒的文学（6） 在《收获》APP“…\n 10  text/part0008.html           5717  ✅           人与自然人民与生态（7） 在《收获》生态…\n 11  text/part0009.html           5697  ✅           “打工”与“壁橱”（8） 在东莞打工文学…\n 12  text/part0010.html           4411  ✅           那座跳伞塔，它还在吗？（9） 在河北大学…\n 13  text/part0011.html           2559  ✅           黄鹤去哪儿了？（10） 在2023武汉文…\n 14  text/part0012.html           2256  ✅           有机村庄与点灯（11） 在首届丝绸之路木…\n 15  text/part0013.html           1470  ✅           我们都爱汪曾祺（12） 在《汪曾祺别集》…\n 16  text/part0014.html           6253  ✅           为小说申辩（13） 在万通读书会 必须为…\n 17  text/part0015.html           3071  ✅           请给鲁迅先生做个访谈（14） 在《巴黎评…\n 18  text/part0016.html           2142  ✅           北大人的“旗杆”（15） 在北大中文系2…\n 19  text/part0017.html           5770  ✅           听“空山”（16） 一次想象的讲演 空山…\n 20  text/part0018.html           1577  ✅           跋 我渐渐喜欢上了这种方式，人们把这叫做…\nStarted at: 19:24:49\nTotal characters: 69,287\nTotal words: 390\nEstimated time remaining (assuming 50 chars/sec): 00d 00h 23m 05s\n/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/torch/nn/modules/rnn.py:83: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.2 and num_layers=1\n  warnings.warn(\"dropout option adds dropout after all but last \"\n/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/torch/nn/utils/weight_norm.py:28: UserWarning: torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.\n  warnings.warn(\"torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.\")\nzf_xiaoxiao.pt: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 523k/523k [00:10<00:00, 49.3kB/s]\nBuilding prefix dict from the default dictionary ...\nLoading model from cache /var/folders/f2/l6tgx5v115s6jptszlvb1jwh0000gn/T/jieba.cache\n⠙ Reading chapter 1 (158 characters)...Loading model cost 0.558 seconds.\nPrefix dict has been built successfully.\n⠸ Reading chapter 1 (158 characters)...[W NNPACK.cpp:64] Could not initialize NNPACK! Reason: Unsupported hardware.\n✅ Reading chapter 1 (158 characters)...\nEstimated time remaining: 00d 06h 53m 08s\nChapter written to smallbook_chapter_1_zf_xiaoxiao_text_part0001.html.wav\nChapter 1 read in 56.66 seconds (3 characters per second)\nProgress: 0%\n\n/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/torch/nn/modules/rnn.py:83: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.2 and num_layers=1\n  warnings.warn(\"dropout option adds dropout after all but last \"\n/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/torch/nn/utils/weight_norm.py:28: UserWarning: torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.\n  warnings.warn(\"torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.\")\nTraceback (most recent call last):\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/bin/audiblez\", line 8, in <module>\n    sys.exit(cli_main())\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/audiblez.py\", line 308, in cli_main\n    main(args.epub_file_path, args.voice, args.pick, args.speed)\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/audiblez.py\", line 88, in main\n    audio_segments = gen_audio_segments(pipeline, text, voice, speed)\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/audiblez.py\", line 149, in gen_audio_segments\n    for gs, ps, audio in pipeline(sent.text, voice=voice, speed=speed, split_pattern=r'\\n\\n\\n'):\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/kokoro/pipeline.py\", line 261, in __call__\n    ps = self.g2p(graphemes)\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/misaki/zh.py\", line 37, in __call__\n    segment = ' '.join(type(self).word2ipa(w) for w in words)\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/misaki/zh.py\", line 37, in <genexpr>\n    segment = ' '.join(type(self).word2ipa(w) for w in words)\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/misaki/zh.py\", line 25, in word2ipa\n    return ''.join(cls.py2ipa(py) for py in pinyins)\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/misaki/zh.py\", line 25, in <genexpr>\n    return ''.join(cls.py2ipa(py) for py in pinyins)\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/misaki/zh.py\", line 20, in py2ipa\n    return ''.join(cls.retone(p) for p in pinyin_to_ipa(py)[0])\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/misaki/transcription.py\", line 257, in pinyin_to_ipa\n    pinyin_final = get_finals(pinyin_normal)\n  File \"/Users/zhoubo/anaconda3/envs/radio_os_env/lib/python3.9/site-packages/misaki/transcription.py\", line 222, in get_finals\n    raise ValueError(\"Parameter 'normal_pinyin': Final couldn't be detected!\")\nValueError: Parameter 'normal_pinyin': Final couldn't be detected!\n\n\nPlease help me locate the issue and see if it can be fixed. Thank you.\n\n\n",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/53/comments",
    "author": "pinis123",
    "comments": [
      {
        "user": "liiyee",
        "created_at": "2025-02-09T07:19:44Z",
        "body": "same here."
      },
      {
        "user": "santinic",
        "created_at": "2025-02-10T10:30:47Z",
        "body": "@pinis123 @liiyee This should be fixed in v4, please update and retry"
      }
    ]
  },
  {
    "number": 50,
    "title": "specifying output directory",
    "created_at": "2025-02-07T23:46:39Z",
    "closed_at": "2025-02-11T09:43:30Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/50",
    "body": "hi is there any method for specifying the output directory?",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/50/comments",
    "author": "2arch",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-02-10T10:31:37Z",
        "body": "@2arch This has been implemented in v4, please update and have a try (the option is `-o`)"
      }
    ]
  },
  {
    "number": 47,
    "title": "Permission denied",
    "created_at": "2025-02-06T15:15:23Z",
    "closed_at": "2025-02-11T09:44:30Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/47",
    "body": "Hi, \nI keep having this issue while running the command:\n\nC:\\Users\\Anthony\\AppData\\Local\\Temp\\tmp3b4t0f2i: Permission denied\n\nRight after ffmpeg is starting\n\nI try to run the cmd as local user and admin, I also checked the permission on Temp/ and everything looks good\n\nAny idea?\nThanks\n\n\n",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/47/comments",
    "author": "anthonykozak",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-02-06T21:37:14Z",
        "body": "Noted, I suspect it's a Windws-only bug of a library we use. Are you running it under Windows Linux Subsystem (WLS)? It should work fine if you install it under WLS"
      },
      {
        "user": "santinic",
        "created_at": "2025-02-10T10:33:00Z",
        "body": "This should be fixed in version 4, please update and try again"
      }
    ]
  },
  {
    "number": 44,
    "title": "Error after making all of the chapters: Error opening input file C:\\Users\\gx\\AppData\\Local\\Temp\\tmplp445vuz.",
    "created_at": "2025-02-04T10:35:09Z",
    "closed_at": "2025-02-11T09:44:36Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/44",
    "body": "Hi, I used version o.3 and was able to make all of the chapters into wav files but after the last one when it starts converting to mp4 I get this error \n\n        title           : Chapter 30\n[in#2 @ 000002164bb611c0] Error opening input: Permission denied\nError opening input file C:\\Users\\gx\\AppData\\Local\\Temp\\tmplp445vuz.\nError opening input files: Permission denied\n\nI checked about free space and that doesn´t seem to be a problem.\n\nAlso a suggestion, it would be useful to recognize and skip the index \n\nregards\n",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/44/comments",
    "author": "taladro",
    "comments": [
      {
        "user": "taladro",
        "created_at": "2025-02-06T08:18:33Z",
        "body": "hi, is this something I´m doing wrong?"
      },
      {
        "user": "taladro",
        "created_at": "2025-02-06T15:12:59Z",
        "body": "tried with another smaller and simpler epub to check if that was the problem, but I still get         title           : Chapter 15\n[in#2 @ 000001d35c557fc0] Error opening input: Permission denied\nError opening input file C:\\Users\\gx\\AppData\\Local\\Temp\\tmpkbrmdljj.\nError opening input files: Permission denied "
      },
      {
        "user": "santinic",
        "created_at": "2025-02-10T10:34:15Z",
        "body": "@taladro this Windows-only bug is fixed in latest release. Please update to v4 with `pip install -U audiblez` and try agian, thanks"
      }
    ]
  },
  {
    "number": 43,
    "title": "Can't use Chinese voice option in command?",
    "created_at": "2025-02-03T11:03:52Z",
    "closed_at": "2025-02-03T16:31:56Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/43",
    "body": "Use the command:\naudiblez 242332323232.epub -v zm_yunxia  \nThe error is as follows:\nAssertionError: ('z', {'a': 'American English', 'b': 'British English', 'e': 'es', 'f': 'fr-fr', 'h': 'hi', 'i': 'it', 'p': 'pt-br'})\n\nThe document shows a Chinese language conversion, why can't I use it?\n\n",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/43/comments",
    "author": "HuQingyepersonalprojectsummary",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-02-03T11:43:42Z",
        "body": "Thanks @HuQingyepersonalprojectsummary - Fixed in v0.3.5. \nRun `pip install -U audiblez` and it should work"
      }
    ]
  },
  {
    "number": 42,
    "title": "Improve cover image retrieval logic",
    "created_at": "2025-01-31T21:52:19Z",
    "closed_at": "2025-02-01T09:37:08Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/pull/42",
    "body": null,
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/42/comments",
    "author": "agleyzer",
    "comments": [
      {
        "user": "agleyzer",
        "created_at": "2025-01-31T21:53:51Z",
        "body": "Sorry for multiple commits, my github skills are a bit rusty. I hope they can get squashed."
      },
      {
        "user": "santinic",
        "created_at": "2025-02-01T09:36:44Z",
        "body": "This is great, thanks!"
      }
    ]
  },
  {
    "number": 39,
    "title": "Regression: espeak not enabled in 0.3.0.",
    "created_at": "2025-01-30T06:32:39Z",
    "closed_at": "2025-02-01T17:54:55Z",
    "labels": [
      "v3"
    ],
    "url": "https://github.com/santinic/audiblez/issues/39",
    "body": "The issues with `espeak` documented in #19 are noted; however, it was still functional with out-of-dictionary words in 0.2.2. This is broken in 0.3.0., and out-of-dictionary words like \"Nyiragongo\", \"Kivu\" and \"Banyamulenge\" are skipped in the final output. The error message \n\n> WARNING: EspeakFallback not enabled. Out-of-dictionary words will be skipped. espeak not installed on your system\n\n`espeak-ng`, `espeak_phonemizer`, `misaki`, etc. are all installed, and `pip check` shows no dependency issues.",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/39/comments",
    "author": "ekenwere",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-01-30T08:30:25Z",
        "body": "Yes, thanks, I rolled back to 0.2.2. v3 will need more work"
      },
      {
        "user": "santinic",
        "created_at": "2025-02-01T12:05:16Z",
        "body": "Please, update and try again. v3.1 comes with a lot of changes. Check README for installation instructions, it's slightly different"
      }
    ]
  },
  {
    "number": 36,
    "title": "v3 overwriting .wav files creating incomplete short book",
    "created_at": "2025-01-29T23:44:23Z",
    "closed_at": "2025-02-01T23:22:03Z",
    "labels": [
      "v3"
    ],
    "url": "https://github.com/santinic/audiblez/issues/36",
    "body": "After updating to v3 `pip install --upgrade audiblez` and creating a new book `audiblez Durarara\\ Vol\\ 4.epub  -v af_bella  -s 1.0` short chapters are created and if looking directly at the folder in File Explorer, you notice the file always changing in size and often becoming much shorter. Tested on new virtual env as well.",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/36/comments",
    "author": "erictbar",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-01-30T08:30:42Z",
        "body": "Yes, thanks, I rolled back to 0.2.2. v3 will need more work"
      },
      {
        "user": "sameh0",
        "created_at": "2025-01-31T11:34:22Z",
        "body": "@erictbar could you please checkout if the fix works for you ?"
      },
      {
        "user": "erictbar",
        "created_at": "2025-01-31T14:13:51Z",
        "body": "Yes, branch `v3` is working for me."
      },
      {
        "user": "santinic",
        "created_at": "2025-01-31T16:33:03Z",
        "body": "@erictbar fix chunks up the text file basically at random, so the pronunciation is unnatural. I'm moving v3 to use spacy for sentence splitting"
      },
      {
        "user": "santinic",
        "created_at": "2025-02-01T12:05:28Z",
        "body": "Please, update and try again. v3.1 comes with a lot of changes"
      }
    ]
  },
  {
    "number": 32,
    "title": "possible to convert pdfs?",
    "created_at": "2025-01-27T23:08:16Z",
    "closed_at": "2025-02-06T21:55:11Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/32",
    "body": "any documented way of converting pdfs to audio instead of epub",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/32/comments",
    "author": "2arch",
    "comments": [
      {
        "user": "BentleyOph",
        "created_at": "2025-02-03T15:04:30Z",
        "body": "Wondering about the same too..does it only work with epubs?"
      },
      {
        "user": "virinci",
        "created_at": "2025-02-04T12:15:57Z",
        "body": "@2arch @BentleyOph Yes, it only works with EPUBs. You can either convert the PDFs to EPUB files or create an issue for adding PDF support.\nIt is possible to make the core independent of any input file format and have a plugin system for adding support for file types such as markdown, PDF, EPUB, etc. I doubt the maintainer is interested in extending it though."
      }
    ]
  },
  {
    "number": 31,
    "title": "Support list items",
    "created_at": "2025-01-27T09:26:10Z",
    "closed_at": "2025-01-27T13:36:29Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/31",
    "body": "Thank you for the amazing tool!\n\nBullet points are skipped in the output audio. Adding `li` to `html_content_tags` will fix this. Would you like a PR for this?",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/31/comments",
    "author": "abdullahgira",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-01-27T13:36:29Z",
        "body": "I'll do it thanks"
      }
    ]
  },
  {
    "number": 30,
    "title": "GPU not utilized on MacBook M4 Max",
    "created_at": "2025-01-26T18:11:25Z",
    "closed_at": "2025-02-01T23:24:02Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/30",
    "body": "**Environment**  \n- **Device:** MacBook M4 Max  \n- **GPU Cores:** 40\n- **Audiblez Version:** (please specify)  \n- **ONNXRuntime Version:** Installed via Homebrew (`onnxruntime`)  \n- **Python Version:** 3.12\n- **macOS Version:** 15.2\n\n**Description**  \nWhen encoding an eBook (`ebook.epub`) to MP4 with Audiblez using ONNX providers (`CoreMLExecutionProvider` and `CPUExecutionProvider`), the GPU is not being utilized. The macOS GPU History widget shows 0% GPU usage, resulting in extremely long encoding times for a small eBook.\n\n**Commands Run**  \n1. Install ONNXRuntime and Audiblez:  \n   ```bash\n   python3.12 -m venv venv\n    . ./venv/bin/activate\n   pip install audiblez\n   brew install onnxruntime\n   ```\n2. Verify available ONNXRuntime providers:  \n   ```bash\n   python -c \"import onnxruntime as ort; print(ort.get_available_providers())\"\n   ```\n   Output:  \n   ```python\n   ['CoreMLExecutionProvider', 'AzureExecutionProvider', 'CPUExecutionProvider']\n   ```\n3. Encode the eBook:  \n   ```bash\n   audiblez ebook.epub -l en-gb -v af_sky -s 1.5 --providers CoreMLExecutionProvider CPUExecutionProvider\n   2025-01-26 18:57:14.034625 [W:onnxruntime:, coreml_execution_provider.cc:115 GetCapability] CoreMLExecutionProvider::GetCapability, number of partitions supported by CoreML: 129 number of nodes in the graph: 2478 number of nodes supported by CoreML: 1051\n   Using ONNX providers: CoreMLExecutionProvider, CPUExecutionProvider\n   Found Chapters: ['toc.xhtml', 'cover.xhtml', 'chapter-1.xhtml']\n   Automatically selected chapters: ['chapter-1.xhtml']\n   Started at: 18:57:16\n   Total characters: 428,365\n   Total words: 71866\n   Estimated time remaining: 00d 05h 56m 58s\n   Reading chapter 1 (428,365 characters)...\n   Context leak detected, msgtracer returned -1\n   Context leak detected, msgtracer returned -1\n   Context leak detected, msgtracer returned -1\n   ```\n\n**Observations**  \n- **GPU Utilization:** 0% (verified using macOS GPU History widget).  \n- **Encoding Time:** Excessive for a single chapter eBook (~5 hours estimated).  \n- **ONNXRuntime Logs:**  \n  ```plaintext\n  2025-01-26 18:57:14.034625 [W:onnxruntime:, coreml_execution_provider.cc:115 GetCapability] CoreMLExecutionProvider::GetCapability, number of partitions supported by CoreML: 129 number of nodes in the graph: 2478 number of nodes supported by CoreML: 1051\n  Using ONNX providers: CoreMLExecutionProvider, CPUExecutionProvider\n  ```\n- **Other Warnings:**  \n  - `Context leak detected, msgtracer returned -1` (repeated multiple times).\n\n**Expected Behavior**  \nThe encoding process should utilize the GPU cores available on the Mac M4 to accelerate processing.\n\n**Reproduction Steps**  \n1. Install Audiblez and ONNXRuntime.  \n2. Run the command:  \n   ```bash\n   audiblez ebook.epub -l en-gb -v af_sky -s 1.5 --providers CoreMLExecutionProvider CPUExecutionProvider\n   ```\n3. Monitor GPU utilization during the process.\n\n**Possible Issues**  \n- Misconfiguration or incomplete support for `CoreMLExecutionProvider` in Audiblez.  \n- Audiblez is not properly leveraging GPU acceleration via ONNXRuntime.  \n- Context leaks may be interfering with proper execution.\n\n**Additional Information**  \n- **Total Characters:** 428,365  \n- **Total Words:** 71,866  \n- **Chapters Processed:** `chapter-1.xhtml`",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/30/comments",
    "author": "keyboardsamurai",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-01-27T13:39:13Z",
        "body": "I have the same issue, it must be an issue with kokoro-onnx"
      }
    ]
  },
  {
    "number": 25,
    "title": "Add cover image to the output audio file and some minor refactoring",
    "created_at": "2025-01-22T17:02:29Z",
    "closed_at": "2025-01-23T20:32:24Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/pull/25",
    "body": "Closes #24 \r\nThe command for adding cover image is taken from that issue.",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/25/comments",
    "author": "virinci",
    "comments": [
      {
        "user": "elloskelling",
        "created_at": "2025-01-23T19:36:15Z",
        "body": "Thank you :-)"
      }
    ]
  },
  {
    "number": 22,
    "title": "Update audiblez.py",
    "created_at": "2025-01-21T21:11:40Z",
    "closed_at": "2025-01-23T20:27:08Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/pull/22",
    "body": "This seems like a complex script where the logic may not be apparent to some people, so I added a few comments to enhance readability. I'll add more code and some extra comments in the future.",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/22/comments",
    "author": "Ishan-Karpe",
    "comments": [
      {
        "user": "Ishan-Karpe",
        "created_at": "2025-01-24T00:54:38Z",
        "body": "Why close? It's not just about fixing issues, many newcomers want to contribute too in some way."
      },
      {
        "user": "santinic",
        "created_at": "2025-01-24T09:24:23Z",
        "body": "Sorry, thanks for your contribution. Too muc other stuff to merge "
      }
    ]
  },
  {
    "number": 16,
    "title": "Seems to skip writing and only convert chapter titles",
    "created_at": "2025-01-17T10:29:59Z",
    "closed_at": "2025-01-24T09:29:10Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/16",
    "body": "I just tested it on an ebook I have and it's only converts the chapter titles to voice, so I get 10 files each one only voicing the chapter.\n\nIs there something I can do to fix this.",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/16/comments",
    "author": "gambithunt",
    "comments": [
      {
        "user": "virinci",
        "created_at": "2025-01-19T15:37:42Z",
        "body": "@gambithunt It must be specific to the `.epub` file you are using. For example, the chapter contents being incorrectly formatted.  You can share the file to help the dev debug the issue."
      }
    ]
  },
  {
    "number": 14,
    "title": "Support for onnxruntime-gpu and documentation.",
    "created_at": "2025-01-17T04:11:36Z",
    "closed_at": "2025-01-17T08:30:17Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/pull/14",
    "body": "### Pull Request: Add ONNXRuntime Provider Support and Documentation Updates\r\n\r\n#### Summary\r\nThis PR introduces support for specifying ONNXRuntime providers via the `--providers` CLI option, enabling users to optimize audiobook generation performance. It also updates documentation to include instructions for GPU acceleration with `onnxruntime-gpu`.\r\n\r\n---\r\n\r\n#### Key Changes\r\n1. **ONNXRuntime Provider Support:**\r\n   - Added `--providers` argument to specify execution providers (e.g., `CUDAExecutionProvider`).\r\n   - Validates user-provided providers against available options.\r\n\r\n2. **Dynamic Help:**\r\n   - `--providers` help text now includes the list of available ONNXRuntime providers on the system.\r\n\r\n3. **Documentation Updates:**\r\n   - Added instructions for installing `onnxruntime-gpu`.\r\n   - Included examples for using `--providers` and checking available providers.\r\n\r\n---\r\n\r\n#### Testing\r\n- Verify default behavior remains unchanged without `--providers`.\r\n- Test with valid providers (e.g., `CUDAExecutionProvider`) and confirm correct application.\r\n- Validate error handling for invalid providers.\r\n- Check `--help` output for accurate provider information.\r\n\r\n---\r\n\r\n#### Compatibility\r\nThese changes are fully backward compatible. The `--providers` argument is optional, and the default provider (`CPUExecutionProvider`) is used when none is specified.\r\n\r\n---\r\n\r\n#### Example\r\n```bash\r\naudiblez book.epub -l en-gb -v af_sky --providers CUDAExecutionProvider\r\n```\r\n",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/14/comments",
    "author": "patrickdeanbrown",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-01-17T08:30:29Z",
        "body": "Amazing, thanks ❤️"
      }
    ]
  },
  {
    "number": 13,
    "title": "Not concatenating - perhaps due to 0 char chapter?",
    "created_at": "2025-01-16T11:12:40Z",
    "closed_at": "2025-01-16T14:26:30Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/13",
    "body": "The wav files are created but don't get concatenated into on an epub. Perhaps a problem with one of my chapters having 0 characters? \r\n\r\nWill checking for that help?\r\n\r\n```\r\nif len(text.strip()) == 0:\r\n    print(f'Skipping empty chapter {i}')\r\n    continue\r\n```\r\n\r\nSee full shell notes below:\r\n\r\n```\r\naudiblez moraleducation.epub -l en-us -v af_sky                                [ruby-3.1.2p20]\r\n/Users/kml/.local/pipx/venvs/audiblez/lib/python3.11/site-packages/ebooklib/epub.py:1395: UserWarning: In the future version we will turn default option ignore_ncx to True.\r\n  warnings.warn('In the future version we will turn default option ignore_ncx to True.')\r\n/Users/kml/.local/pipx/venvs/audiblez/lib/python3.11/site-packages/ebooklib/epub.py:1423: FutureWarning: This search incorrectly ignores the root element, and will be fixed in a future version.  If you rely on the current behaviour, change it to './/xmlns:rootfile[@media-type]'\r\n  for root_file in tree.findall('//xmlns:rootfile[@media-type]', namespaces={'xmlns': NAMESPACES['CONTAINERNS']}):\r\nConfucian Ritual and Moral Education by Colin J. Lewis\r\n'1-A01-LEX.Series_cover.xhtml', #139\r\n'1-A01-LEX.Series_frontmatter.xhtml', #7342\r\n'3-B02-acknowledgements.xhtml', #1383\r\n'4-B03-introduction.xhtml', #20051\r\n'5-C01-chap01.xhtml', #58515\r\n'6-C02-chap02.xhtml', #57813\r\n'7-C03-chap03.xhtml', #71775\r\n'8-C04-chap04.xhtml', #64725\r\n'9-C05-chap05.xhtml', #43459\r\n'10-C06-chap06.xhtml', #81755\r\n'11-C07-chap07.xhtml', #66457\r\n'12-C08-chap08.xhtml', #53564\r\n'13-D01-bibliography.xhtml', #57232\r\n'14-I01-index.xhtml', #93614\r\n'15-J01-author.xhtml', #875\r\n'toc_nav.xhtml', #1217\r\nNot easy to find the chapters, defaulting to all available documents.\r\nFound chapters: ['1-A01-LEX.Series_cover.xhtml', '1-A01-LEX.Series_frontmatter.xhtml', '3-B02-acknowledgements.xhtml', '4-B03-introduction.xhtml', '5-C01-chap01.xhtml', '6-C02-chap02.xhtml', '7-C03-chap03.xhtml', '8-C04-chap04.xhtml', '9-C05-chap05.xhtml', '10-C06-chap06.xhtml', '11-C07-chap07.xhtml', '12-C08-chap08.xhtml', '13-D01-bibliography.xhtml', '14-I01-index.xhtml', '15-J01-author.xhtml', 'toc_nav.xhtml']\r\nStarted at: 17:53:22\r\nTotal characters: 493,141\r\nTotal words: 106671\r\nReading chapter 1 (0 characters)...\r\nEstimated time remaining: 03d 01h 21m 58s\r\nChapter written to moraleducation_chapter_1.wav\r\nChapter 1 read in 30.53 seconds (2 characters per second)\r\nProgress: 0%\r\nReading chapter 2 (3,352 characters)...\r\nEstimated time remaining: 00d 01h 54m 23s\r\nChapter written to moraleducation_chapter_2.wav\r\nChapter 2 read in 46.65 seconds (72 characters per second)\r\nProgress: 0%\r\nReading chapter 3 (1,255 characters)...\r\nEstimated time remaining: 00d 01h 33m 19s\r\nChapter written to moraleducation_chapter_3.wav\r\nChapter 3 read in 14.35 seconds (87 characters per second)\r\nProgress: 0%\r\nReading chapter 4 (17,643 characters)...\r\nEstimated time remaining: 00d 01h 33m 23s\r\nChapter written to moraleducation_chapter_4.wav\r\nChapter 4 read in 202.37 seconds (87 characters per second)\r\nProgress: 0%\r\nReading chapter 5 (52,472 characters)...\r\nEstimated time remaining: 00d 01h 29m 26s\r\nChapter written to moraleducation_chapter_5.wav\r\nChapter 5 read in 598.04 seconds (88 characters per second)\r\nProgress: 4%\r\nReading chapter 6 (49,130 characters)...\r\nEstimated time remaining: 00d 01h 19m 15s\r\nChapter written to moraleducation_chapter_6.wav\r\nChapter 6 read in 558.39 seconds (88 characters per second)\r\nProgress: 15%\r\nReading chapter 7 (59,415 characters)...\r\nEstimated time remaining: 00d 11h 51m 50s\r\nChapter written to moraleducation_chapter_7.wav\r\nChapter 7 read in 6871.68 seconds (9 characters per second)\r\nProgress: 25%\r\nReading chapter 8 (56,244 characters)...\r\nEstimated time remaining: 00d 02h 27m 53s\r\nChapter written to moraleducation_chapter_8.wav\r\nChapter 8 read in 1610.51 seconds (35 characters per second)\r\nProgress: 37%\r\nReading chapter 9 (38,232 characters)...\r\nEstimated time remaining: 00d 00h 49m 30s\r\nChapter written to moraleducation_chapter_9.wav\r\nChapter 9 read in 447.74 seconds (85 characters per second)\r\nProgress: 48%\r\nReading chapter 10 (71,786 characters)...\r\nEstimated time remaining: 00d 00h 40m 43s\r\nChapter written to moraleducation_chapter_10.wav\r\nChapter 10 read in 814.37 seconds (88 characters per second)\r\nProgress: 56%\r\nReading chapter 11 (57,001 characters)...\r\nEstimated time remaining: 00d 00h 28m 48s\r\nChapter written to moraleducation_chapter_11.wav\r\nChapter 11 read in 685.97 seconds (83 characters per second)\r\nProgress: 70%\r\nReading chapter 12 (47,453 characters)...\r\nEstimated time remaining: 00d 00h 16m 35s\r\nChapter written to moraleducation_chapter_12.wav\r\nChapter 12 read in 545.16 seconds (87 characters per second)\r\nProgress: 82%\r\nReading chapter 13 (38,391 characters)...\r\nEstimated time remaining: 00d 00h 10m 25s\r\nChapter written to moraleducation_chapter_13.wav\r\nChapter 13 read in 612.98 seconds (63 characters per second)\r\nProgress: 92%\r\nReading chapter 14 (6 characters)...\r\nEstimated time remaining: 00d 00h 02m 19s\r\nChapter written to moraleducation_chapter_14.wav\r\nChapter 14 read in 1.09 seconds (6 characters per second)\r\nProgress: 99%\r\nReading chapter 15 (761 characters)...\r\nEstimated time remaining: 00d 00h 00m 09s\r\nChapter written to moraleducation_chapter_15.wav\r\nChapter 15 read in 9.91 seconds (77 characters per second)\r\nProgress: 99%\r\nReading chapter 16 (0 characters)...\r\nTraceback (most recent call last):\r\n  File \"/Users/kml/.local/bin/audiblez\", line 8, in <module>\r\n    sys.exit(cli_main())\r\n             ^^^^^^^^^^\r\n  File \"/Users/kml/.local/pipx/venvs/audiblez/lib/python3.11/site-packages/audiblez.py\", line 163, in cli_main\r\n    main(kokoro, args.epub_file_path, args.lang, args.voice)\r\n  File \"/Users/kml/.local/pipx/venvs/audiblez/lib/python3.11/site-packages/audiblez.py\", line 55, in main\r\n    samples, sample_rate = kokoro.create(text, voice=voice, speed=1.0, lang=lang)\r\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/Users/kml/.local/pipx/venvs/audiblez/lib/python3.11/site-packages/kokoro_onnx/__init__.py\", line 152, in create\r\n    audio = np.concatenate(audio)\r\n            ^^^^^^^^^^^^^^^^^^^^^\r\nValueError: need at least one array to concatenate\r\n```",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/13/comments",
    "author": "kmlawson",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-01-16T14:26:30Z",
        "body": "You're right, fixed. pip install again and it should work"
      }
    ]
  },
  {
    "number": 12,
    "title": "Error while concatenating audio files",
    "created_at": "2025-01-16T08:23:35Z",
    "closed_at": "2025-01-16T09:07:45Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/12",
    "body": "I ran Audiblez against an epub file. At the end of the process (it seems), the following exception was produced and no book output file was created.\r\n\r\nPerhaps the chapter being 0 characters caused it? Unsure of how the chapter is 0 characters. I can provide the epub file if requested, though can't share it here.\r\n\r\n```\r\nReading chapter 27 (276 characters)...\r\nEstimated time remaining: 00d 00h 00m 33s\r\nChapter written to book_chapter_27.wav\r\nChapter 27 read in 6.14 seconds (45 characters per second)\r\nProgress: 99%\r\nReading chapter 28 (0 characters)...\r\nTraceback (most recent call last):\r\n  File \"/Users/xxx/dev/audiblez/.venv/bin/audiblez\", line 8, in <module>\r\n    sys.exit(cli_main())\r\n             ^^^^^^^^^^\r\n  File \"/Users/xxx/dev/audiblez/.venv/lib/python3.12/site-packages/audiblez.py\", line 160, in cli_main\r\n    main(kokoro, args.epub_file_path, args.lang, args.voice)\r\n  File \"/Users/xxx/dev/audiblez/.venv/lib/python3.12/site-packages/audiblez.py\", line 55, in main\r\n    samples, sample_rate = kokoro.create(text, voice=voice, speed=1.0, lang=lang)\r\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/Users/xxx/dev/audiblez/.venv/lib/python3.12/site-packages/kokoro_onnx/__init__.py\", line 152, in create\r\n    audio = np.concatenate(audio)\r\n            ^^^^^^^^^^^^^^^^^^^^^\r\n```",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/12/comments",
    "author": "naptar",
    "comments": [
      {
        "user": "santinic",
        "created_at": "2025-01-16T09:07:45Z",
        "body": "This is already fixed, make sure you reinstall with `pip install -U audiblez` "
      }
    ]
  },
  {
    "number": 11,
    "title": "Adds generation of chapter markings in the audiobook",
    "created_at": "2025-01-16T07:05:17Z",
    "closed_at": "2025-01-23T20:26:34Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/pull/11",
    "body": "This patch tracks the length of the generated audio (or uses ffprobe to recover it from the files if not available e.g. when files are already present) and generates a chapters file that is fed to ffmpeg to add chapter markings.",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/11/comments",
    "author": "emdioh",
    "comments": [
      {
        "user": "virinci",
        "created_at": "2025-01-19T16:08:23Z",
        "body": "@emdioh Wouldn't it be better to include the chapter name too instead of just the chapter numbers?"
      }
    ]
  },
  {
    "number": 10,
    "title": "can't install audiblez",
    "created_at": "2025-01-16T03:48:56Z",
    "closed_at": "2025-01-16T08:57:45Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/issues/10",
    "body": "ubuntu20.04\r\npip 20.0.2 from /usr/lib/python3/dist-packages/pip (python 3.8)\r\n\r\nwhen I run \"pip install audiblez\", I was told:\r\nERROR: Could not find a version that satisfies the requirement audiblez (from versions: none)\r\nERROR: No matching distribution found for audiblez\r\n\r\n",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/10/comments",
    "author": "klefjkl",
    "comments": [
      {
        "user": "jamesdeluk",
        "created_at": "2025-01-16T08:02:23Z",
        "body": "Requires Python <3.13, >=3.9"
      }
    ]
  },
  {
    "number": 7,
    "title": "Preserve the order that the user selects chapters",
    "created_at": "2025-01-15T22:12:43Z",
    "closed_at": "2025-01-23T20:19:12Z",
    "labels": [],
    "url": "https://github.com/santinic/audiblez/pull/7",
    "body": "this helps if the epub file's chapters are out-of-order. Otherwise the output will be out-of-order\r\n\r\nAlso address an issue in the .gitignore file",
    "comments_url": "https://api.github.com/repos/santinic/audiblez/issues/7/comments",
    "author": "plusuncold",
    "comments": [
      {
        "user": "plusuncold",
        "created_at": "2025-01-15T22:18:38Z",
        "body": "Alternatively `chapters` could be sorted in main after they are picked/found"
      },
      {
        "user": "virinci",
        "created_at": "2025-01-19T16:03:35Z",
        "body": "@plusuncold Great idea! The implementation can be shortened like:\r\n\r\n```py\r\ndef pick_chapters(book):\r\n    chapters = [c for c in book.get_items() if c.get_type() == ebooklib.ITEM_DOCUMENT]\r\n    chapter_names = [c.get_name() for c in chapters]\r\n    title = \"Select which chapters to read in the audiobook (in the desired order to be added to the audiobook)\"\r\n    picked = pick(chapter_names, title, multiselect=True, min_selection_count=1)\r\n    selected_chapters = [chapters[i] for _, i in picked]\r\n    return selected_chapters\r\n```\r\nThe `len` check is unnecessary. And `pick` gives us the indices of selections, so why not use it? :)"
      },
      {
        "user": "santinic",
        "created_at": "2025-01-23T20:19:12Z",
        "body": "I find this a bit confusing, I don't expect the app to keep the order I select them, but thanks for your contribution!"
      }
    ]
  }
]