[
  {
    "number": 39,
    "title": "\u4e3a\u4ec0\u4e48sensevoice\u6a21\u578b\u7684\u8f93\u5165\u662fNXTX560\uff1f",
    "created_at": "2024-12-20T03:14:03Z",
    "closed_at": "2024-12-20T03:55:12Z",
    "labels": [],
    "url": "https://github.com/lovemefan/SenseVoice.cpp/issues/39",
    "body": "\u5f88\u591aasr\u7684\u8f93\u5165\u662fNXTX80, sensevoice\u7684560\u662f\u4ec0\u4e48\u542b\u4e49",
    "comments_url": "https://api.github.com/repos/lovemefan/SenseVoice.cpp/issues/39/comments",
    "author": "dlkht",
    "comments": [
      {
        "user": "lovemefan",
        "created_at": "2024-12-20T03:52:56Z",
        "body": "\u8bba\u6587\u4e2dLFR\uff08lower frame rate\uff09\u6280\u672f\u5c067\u5e27fbank \uff08\u4e00\u5e2780\u7ef4\uff09\u62fc\u6210\u4e86\u4e00\u5e27\uff0c\u6240\u4ee5\u7ef4\u5ea6\u662f560"
      },
      {
        "user": "dlkht",
        "created_at": "2024-12-20T03:53:50Z",
        "body": "\u8c22\u8c22"
      },
      {
        "user": "lovemefan",
        "created_at": "2024-12-20T03:55:12Z",
        "body": "\u4e0d\u5ba2\u6c14"
      }
    ]
  },
  {
    "number": 25,
    "title": "MacBook Pro M1 \u6309\u7167\u8bf4\u660e\u7f16\u8bd1\u62a5\u9519",
    "created_at": "2024-10-20T12:56:04Z",
    "closed_at": "2024-10-21T01:49:23Z",
    "labels": [],
    "url": "https://github.com/lovemefan/SenseVoice.cpp/issues/25",
    "body": "`/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice-decoder.cc:125:13: error: use of undeclared identifier 'ggml_backend_metal_set_n_cb'\r\n            ggml_backend_metal_set_n_cb(backend, n_threads);\r\n            ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice.cc:120:25: warning: unused variable 'key' [-Wunused-variable]\r\n            const char *key = gguf_get_key(gguf_ctx, i);\r\n                        ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice.cc:175:22: warning: unused variable 'scale' [-Wunused-variable]\r\n        const size_t scale = sense_voice.hparams.ftype ? 1 : 2;\r\n                     ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice.cc:262:20: warning: variable 'buffer_size' set but not used [-Wunused-but-set-variable]\r\n            size_t buffer_size = 32*1024; // need some extra room??\r\n                   ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice.cc:237:21: warning: unused variable 'hparams' [-Wunused-variable]\r\n        const auto &hparams = sense_voice.hparams;\r\n                    ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice.cc:229:12: warning: unused variable 'ctx_size' [-Wunused-variable]\r\n    size_t ctx_size = 0;\r\n           ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice.cc:231:21: warning: unused variable 'wtype' [-Wunused-variable]\r\n    const ggml_type wtype = sctx.wtype;\r\n                    ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice.cc:232:21: warning: unused variable 'vtype' [-Wunused-variable]\r\n    const ggml_type vtype =\r\n                    ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice-encoder.cc:113:9: error: use of undeclared identifier 'ggml_backend_metal_log_set_callback'\r\n        ggml_backend_metal_log_set_callback(g_state.log_callback,\r\n        ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/examples/common-ggml.cc:250:17: warning: variable 'nelements' set but not used [-Wunused-but-set-variable]\r\n        int32_t nelements = 1;\r\n                ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/examples/common-ggml.cc:336:21: warning: variable 'f32_data' is uninitialized when used here [-Wuninitialized]/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice-encoder.cc:\r\n163:13: error:                     f32_data[i] = ggml_fp16_to_fp32(data_f16[i]);\r\nuse of undeclared identifier 'ggml_backend_metal_set_n_cb'                    ^~~~~~~~\r\n\r\n            ggml_backend_metal_set_n_cb(backend, n_threads);\r\n            ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/examples/common-ggml.cc:329:29: note: initialize the variable 'f32_data' to silence this warning\r\n            float * f32_data;\r\n                            ^\r\n                             = nullptr\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice-encoder.cc:458:17: warning: unused variable 'model' [-Wunused-variable]\r\n    const auto &model = ctx.model;\r\n                ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice.cc:410:9: error: use of undeclared identifier 'ggml_backend_metal_log_set_callback'\r\n        ggml_backend_metal_log_set_callback(g_state.log_callback, g_state.log_callback_user_data);\r\n        ^\r\n/Users/soulmayon/desktop/ali/SenseVoice.cpp/sense-voice/csrc/sense-voice.cc:763:19: warning: unused variable 'n_ctx' [-Wunused-variable]\r\n        const int n_ctx = state->feature.n_len;\r\n                  ^\r\n`",
    "comments_url": "https://api.github.com/repos/lovemefan/SenseVoice.cpp/issues/25/comments",
    "author": "soulmayon",
    "comments": [
      {
        "user": "lovemefan",
        "created_at": "2024-10-20T14:44:25Z",
        "body": "\u7531\u4e8e\u6700\u65b0ggml\u7684api\u53d8\u5316\uff0c\u8bf7\u66f4\u65b0\u6700\u65b0\u4ee3\u7801"
      },
      {
        "user": "soulmayon",
        "created_at": "2024-10-21T00:01:12Z",
        "body": "\u5df2\u66f4\u65b0\uff0c\u8fd9\u6b21\u53ea\u6709\u8b66\u544awarning: unused variable\u4f46\u4e0d\u62a5\u9519\u4e86\uff0c\u975e\u5e38\u611f\u8c22"
      }
    ]
  },
  {
    "number": 14,
    "title": "failed to read WAV file 'SenseVoice.cpp/data/test1.wav'",
    "created_at": "2024-09-16T13:16:50Z",
    "closed_at": "2024-10-06T14:46:17Z",
    "labels": [],
    "url": "https://github.com/lovemefan/SenseVoice.cpp/issues/14",
    "body": "Expected subchunk1_id 0x20746d66. Given: 0x4b4e554a\r\nerror: failed to read WAV file 'SenseVoice.cpp/data/test1.wav'\r\n\r\n\u6211\u7535\u8111\u4e0a\u5f55\u4e86\u4e00\u4e2aWAV\u683c\u5f0f\u97f3\u9891\uff0c\u63a8\u7406\u7684\u65f6\u5019\u63d0\u793a\u4ee5\u4e0a\u9519\u8bef\uff0c\u60f3\u95ee\u4e0b\u662f\u4ec0\u4e48\u539f\u56e0\u5462\u3002\r\n",
    "comments_url": "https://api.github.com/repos/lovemefan/SenseVoice.cpp/issues/14/comments",
    "author": "brisyramshere",
    "comments": [
      {
        "user": "lovemefan",
        "created_at": "2024-09-16T15:41:14Z",
        "body": "\u786e\u4fdd\u97f3\u9891\u4e3a 16kHz\uff0c\u5355\u901a\u9053\u7684wav\uff0c\u53ef\u4ee5\u4f7f\u7528ffmpeg\u8f6c\u6362\r\n\r\n```\r\nffmpeg -i /path/test1.wav -ar 16000 -ac 1 /path/output.wav\r\n```"
      },
      {
        "user": "brisyramshere",
        "created_at": "2024-09-17T05:11:34Z",
        "body": "> \u786e\u4fdd\u97f3\u9891\u4e3a 16kHz\uff0c\u5355\u901a\u9053\u7684wav\uff0c\u53ef\u4ee5\u4f7f\u7528ffmpeg\u8f6c\u6362\r\n> \r\n> ```\r\n> ffmpeg -i /path/test1.wav -ar 16000 -ac 1 /path/output.wav\r\n> ```\r\n\r\n\u4e86\u89e3\u4e86\uff0c\u8c22\u8c22"
      }
    ]
  },
  {
    "number": 3,
    "title": "Can't run in macos Apple M2 Ultra",
    "created_at": "2024-08-21T10:16:05Z",
    "closed_at": "2024-08-21T12:48:17Z",
    "labels": [],
    "url": "https://github.com/lovemefan/SenseVoice.cpp/issues/3",
    "body": "build in macos\uff0c\r\n\r\nthe log as following\uff1a\r\n```\r\n(base) fanmac@M2-Ultra-Lan SenseVoice.cpp % ./build/bin/sense-voice-main -m ./models/gguf-fp32-sense-voice-small.bin ./asr_example_zh.wav -t 4\r\nsense_voice_small_init_from_file_with_params_no_state: loading model from './models/gguf-fp32-sense-voice-small.bin'\r\nsense_voice_init_with_params_no_state: use gpu    = 1\r\nsense_voice_init_with_params_no_state: flash attn = 0\r\nsense_voice_init_with_params_no_state: gpu_device = 0\r\nsense_voice_model_load: version:      3\r\nsense_voice_model_load: alignment:   32\r\nsense_voice_model_load: data offset: 444480\r\nsense_voice_model_load: loading model\r\nsense_voice_model_load: n_vocab = 25055\r\nsense_voice_model_load: n_encoder_hidden_state = 512\r\nsense_voice_model_load: n_encoder_linear_units = 2048\r\nsense_voice_model_load: n_encoder_attention_heads  = 4\r\nsense_voice_model_load: n_encoder_layers = 50\r\nsense_voice_model_load: n_mels  = 80\r\nsense_voice_model_load: ftype  = 1\r\nsense_voice_model_load: vocab[25055] loaded\r\nsense_voice_model_load: Metal total size =   935.21 MB\r\nsense_voice_model_load: n_tensors: 1197\r\nsense_voice_model_load: load SenseVoiceSmall takes 0.317000 second \r\nsense_voice_backend_init_gpu: using Metal backend\r\nggml_metal_init: allocating\r\nggml_metal_init: found device: Apple M2 Ultra\r\nggml_metal_init: picking default device: Apple M2 Ultra\r\nggml_metal_init: using embedded metal library\r\nggml_metal_init: GPU name:   Apple M2 Ultra\r\nggml_metal_init: GPU family: MTLGPUFamilyApple8  (1008)\r\nggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)\r\nggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)\r\nggml_metal_init: simdgroup reduction support   = true\r\nggml_metal_init: simdgroup matrix mul. support = true\r\nggml_metal_init: hasUnifiedMemory              = true\r\nggml_metal_init: recommendedMaxWorkingSetSize  = 154618.82 MB\r\nsense_voice_init_state: kv pad  size  =    3.67 MB\r\nggml_backend_metal_buffer_type_alloc_buffer: error: failed to allocate buffer, size =     0.00 MiB\r\nggml_gallocr_reserve_n: failed to allocate Metal buffer of size 0\r\nzsh: segmentation fault  ./build/bin/sense-voice-main -m ./models/gguf-fp32-sense-voice-small.bin  -t \r\n```",
    "comments_url": "https://api.github.com/repos/lovemefan/SenseVoice.cpp/issues/3/comments",
    "author": "edisonzf2020",
    "comments": [
      {
        "user": "lovemefan",
        "created_at": "2024-08-21T12:45:18Z",
        "body": "Unfortunately, the Metal GPU backend is not supported yet, only the CPU can be used for now. I\u2019ll do my best to adapt it."
      },
      {
        "user": "edisonzf2020",
        "created_at": "2024-08-21T12:48:12Z",
        "body": "cool work, I run it ok by -ng parameter."
      }
    ]
  }
]