[
  {
    "number": 12020,
    "title": "Deleted sysadmin user by mistake",
    "created_at": "2024-11-07T08:35:15Z",
    "closed_at": "2024-11-11T08:34:13Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/12020",
    "body": "**Component**\r\n\r\n<!-- Choose one of the following and delete all others. -->\r\n * Generic\r\n\r\n**Description**\r\nIt is a super silly question, but, my coworker removed the sysadmin user by mistake from the Thingsboard database. How can I create it again?\r\n\r\n**Environment**\r\n<!-- Add information about your environment and ThingsBoard version if applicable -->\r\n * OS:  Ubuntu 22.04\r\n * ThingsBoard: 3.8\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/12020/comments",
    "author": "jortega11",
    "comments": [
      {
        "user": "dealnat",
        "created_at": "2024-11-08T16:23:42Z",
        "body": "Hi,\r\nYou can make another user to be sysadmin. Here is the list of commands:\r\n```\r\nupdate tb_user set authority = 'SYS_ADMIN' where email = 'customer@thingsboard.org';\r\nupdate tb_user set customer_id = '13814000-1dd2-11b2-8080-808080808080' where email = 'customer@thingsboard.org';\r\nupdate tb_user set tenant_id = '13814000-1dd2-11b2-8080-808080808080' where email = 'customer@thingsboard.org';\r\n```"
      }
    ]
  },
  {
    "number": 11620,
    "title": "View entities in descending order in \"Update Multiple Attributes\" widget",
    "created_at": "2024-09-11T00:33:55Z",
    "closed_at": "2024-09-23T17:58:21Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/11620",
    "body": "**Component**\r\n\r\n * UI\r\n\r\n**Description**\r\nBy default, the \"Update Multiple Attributes\" widget will display entities in an ascending order. If I have an alias that contains three devices named Employee 1, Employee 2, and Employee 3, then the widget will display Employee 3 at the top and Employee 1 at the bottom. I would like to display entities in a descending order instead, such that Employee 1 is at the top and Employee 3 is at the bottom, is there a way to do this?\r\n\r\n**Environment**\r\n * ThingsBoard: 3.7.0",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/11620/comments",
    "author": "zelms",
    "comments": [
      {
        "user": "sumin-denys",
        "created_at": "2024-09-22T16:40:16Z",
        "body": "Hi @zelms,\r\n\r\nThe **_Update Multiple Attributes_** widget sorts entities by creation time. In case you want to display the devices in the following order: Device 1 -> Device 2 -> Device 3, please recreate them in the revert order like that: Device 3 -> Device 2 -> Device 1.\r\n\r\nPlease let me know if you need further help."
      }
    ]
  },
  {
    "number": 11367,
    "title": "How to store our data at widgetContext to use it globally as variable?",
    "created_at": "2024-08-06T13:18:23Z",
    "closed_at": "2024-08-08T09:17:25Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/11367",
    "body": "**Cant we store some of our data at widgetContext to use it globally**\r\n\r\nIf possible, so please let me know how and where.\r\nThank you.",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/11367/comments",
    "author": "KashifAhmd",
    "comments": [
      {
        "user": "devdoob",
        "created_at": "2024-08-08T05:01:57Z",
        "body": "No that's not possible. WidgetContext gets changed for each widget. \r\n\r\nTo use something globally I would suggest you to use stateController.\r\n\r\nPUSH\r\n```\r\nvar stateId = self.ctx.stateController.getStateId();\r\nvar params = self.ctx.stateController.getStateParams();\r\nparams.startDate = self.ctx.$scope.startDate;\r\nself.ctx.stateController.updateState(stateId, params);\r\n```\r\n\r\n PULL\r\n`var startDate = self.ctx.stateController.getStateParams().startDate;`\r\n\r\nThis code is for custom widget... if you want ot use this in TB provided widgets then replace `self.ctx` with `widgetContext`"
      }
    ]
  },
  {
    "number": 11213,
    "title": "How to extract device-gateway data in rulechain?",
    "created_at": "2024-07-16T08:59:34Z",
    "closed_at": "2024-07-16T13:08:20Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/11213",
    "body": "**Component**\r\n * Rule Engine\r\n\r\n**Question**\r\nHow can I get information about GATEWAY originator in rulechain.\r\n\r\n**Description**\r\nI have device that serves as Gateway. It uses MQTT, topic v1/gateway/telemetry to send messages about sensors like:\r\n\r\n`{\r\n\"dev_11\":\r\n[{\r\n\"Temperature\":23.9,\r\n\"RSSI\":-105,\r\n\"Battery\":153\r\n}]\r\n}`\r\n\r\nWorks great - it posts telemetry to rulechain with originator \"dev_11\" but I'd like to save name of the Gateway device that initiated the message. \r\n\r\n\r\n**Environment** \r\n * ThingsBoard: version 3.6.4 CE\r\n\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/11213/comments",
    "author": "LukaszDuss",
    "comments": [
      {
        "user": "devaskim",
        "created_at": "2024-07-16T12:48:10Z",
        "body": "If only one, i.e. the same, gateway pushes `dev_11` 's data each time, so you can get gateway name through `Related Entity Data` node using `Created` relation. Otherwise, there is no such feature to dynamically resolve gateway originator."
      }
    ]
  },
  {
    "number": 10906,
    "title": "Reset User Password without mail",
    "created_at": "2024-05-31T09:22:09Z",
    "closed_at": "2024-05-31T10:30:56Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/10906",
    "body": "**Component**\r\n\r\n<!-- Choose one of the following and delete all others. -->\r\n\r\n * Generic\r\n\r\n**Description**\r\nHi,\r\nI need to reset a forgotten password for a customer who can't receive email, so he can't receive the link for resetting. How can I change his password as tenant administrator without knowing his previous password?\r\nThanks for your answers,\r\n\r\n**Environment**\r\n<!-- Add information about your environment and ThingsBoard version if applicable -->\r\n\r\n * ThingsBoard: 3.5.1 PE\r\n\r\n\r\n___________________________________________________________\r\n\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/10906/comments",
    "author": "liotys",
    "comments": [
      {
        "user": "devdoob",
        "created_at": "2024-05-31T09:34:10Z",
        "body": "Just delete and recreate the user."
      }
    ]
  },
  {
    "number": 10788,
    "title": "How to read response from \"sendTwoWayRpcCommand(entityId,requestBody)\"",
    "created_at": "2024-05-14T10:52:34Z",
    "closed_at": "2024-05-14T13:40:26Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/10788",
    "body": "Hello dears,\r\n\r\ni have a problem for reading response in method in \"sendTwoWayRpcCommand(entityId,requestBody)\" in  \"Latest Value\" type widgets.\r\nI want to press a button, wait for the device to response and display the data returned from the device in the widget.\r\n\r\nIs there a way to solve this specification?",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/10788/comments",
    "author": "hl1369",
    "comments": [
      {
        "user": "devaskim",
        "created_at": "2024-05-14T13:15:22Z",
        "body": "```\r\nsendTwoWayRpcCommand(...).subscribe(\r\n    response => {\r\n        console.log('Response', response);\r\n    },\r\n    error => console.error('Error', error );\r\n);\r\n```"
      },
      {
        "user": "hl1369",
        "created_at": "2024-05-14T13:39:52Z",
        "body": "> ```\r\n> sendTwoWayRpcCommand(...).subscribe(\r\n>     response => {\r\n>         console.log('Response', response);\r\n>     },\r\n>     error => console.error('Error', error );\r\n> );\r\n> ```\r\n\r\nThank you @devaskim i change to this model and work well:\r\ndeviceService.sendTwoWayRpcCommand(entityId,requestBody)\r\n                            .subscribe(\r\n                        function success(response) {\r\n                            console.log(\"send Set ok\");\r\n                            console.log(\"Response payload:\", response); \r\n                        },\r\n                        function fail(rejection) {\r\n                            console.log(\"timeout detect Set\");  \r\n                        }\r\n                    );"
      }
    ]
  },
  {
    "number": 10179,
    "title": "[Question] How can I get the last telemetry value before the time window?",
    "created_at": "2024-02-14T08:25:00Z",
    "closed_at": "2024-02-15T11:28:46Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/10179",
    "body": "**Component**\r\n * UI\r\n\r\n**Description**\r\nI am developing a widget to show the time in which an attribute has been in a state, the problem I have is that I need the previous state before the time window to know if there has been any change, how could I get this value?\r\n\r\n**Environment**\r\nOS: Windows 11 Pro 23H2\r\nThingsBoard: 3.6\r\nBrowser: Microsoft Edge 120.0.2210.133\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/10179/comments",
    "author": "DavidRuizServinet",
    "comments": [
      {
        "user": "devaskim",
        "created_at": "2024-02-14T09:50:13Z",
        "body": "```\r\nself.ctx.attributeService.getEntityTimeseries(entityId, ['YOUR_ATTRIBUTE_NAME'], startPeriodMs, endPeriodMs).subscribe(\r\n    telemetry => console.log('Telemetry', telemetry),\r\n    error=> console.log('Error', error)\r\n);\r\n```"
      },
      {
        "user": "DavidRuizServinet",
        "created_at": "2024-02-14T09:56:54Z",
        "body": "Hello @devaskim I made a mistake indicating that it was an attribute, actually I am the value that I need to obtain comes in a telemetry, how would it be done for that case?"
      },
      {
        "user": "devaskim",
        "created_at": "2024-02-14T09:59:01Z",
        "body": "I gave your proper code"
      }
    ]
  },
  {
    "number": 7433,
    "title": "[Question] Saving Attribute From Custom Widget",
    "created_at": "2022-10-17T10:11:25Z",
    "closed_at": "2022-10-19T10:09:42Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/7433",
    "body": "I'm trying to save a value as an attribute.\r\nI'm using\r\n```\r\nattributeService = self.ctx.$scope.$injector.get('attributeService');\r\nattributeService.saveEntityAttributes(entityId,attributeScope,attributes);\r\n```\r\nI get this error\r\n```\r\nUncaught NullInjectorError: R3InjectorError(class extends o{})[attributeService -> attributeService -> attributeService -> attributeService]: \r\n  NullInjectorError: No provider for attributeService!\r\n```\r\nWhat is the solution for this?",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/7433/comments",
    "author": "inanlia",
    "comments": [
      {
        "user": "devaskim",
        "created_at": "2022-10-17T13:30:11Z",
        "body": "```\r\nself.ctx.$scope.$injector.get(self.ctx.servicesMap.get('attributeService'));\r\n```"
      },
      {
        "user": "inanlia",
        "created_at": "2022-10-19T08:49:00Z",
        "body": "Thank you for your response. The error is gone but the custom widget still does not save the value.\r\nI'm using a latest values custom widget. \r\n\r\nMy code is like this:\r\n       \r\n```\r\nsetTimeout(function() {\r\n        var entityType = \"DEVICE\";\r\n        var entityId = self.ctx.defaultSubscription.data[0].datasource.entityId;\r\n        var attributeScope = \"SERVER_SCOPE\";\r\n        var attributes = [{key:\"key\",value:\"value\"}];\r\n        let attributeService = self.ctx.$scope.$injector.get(self.ctx.servicesMap.get('attributeService'));\r\n        attributeService.saveEntityAttributes(entityId,attributeScope,attributes);\r\n    }, 2500);\r\n```\r\nkey  is already created in device page as a JSON type with \"{}\" as a value.\r\nWidget is supposed to do something else with value before arriving at this part. After doing everything else it is supposed to do it should save the final value as a attribute.\r\n\r\nCan you help with this?"
      },
      {
        "user": "devaskim",
        "created_at": "2022-10-19T09:30:06Z",
        "body": "1. Argument `entityId` should be the following:\r\n```\r\nlet entityId = { id: self.ctx.defaultSubscription.data[0].datasource.entityId, entityType: 'DEVICE' };\r\n```\r\n2. Subscribe for `saveEntityAttributes` result\r\n```\r\nattributeService.saveEntityAttributes(entityId,attributeScope,attributes).subscribe(\r\n    result => console.log('Attribute saved'),\r\n    error => console.log('Error: ', error)\r\n);\r\n```"
      }
    ]
  },
  {
    "number": 7344,
    "title": "Remove sign up from thingsboard login",
    "created_at": "2022-09-28T05:47:53Z",
    "closed_at": "2023-07-27T12:11:36Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/7344",
    "body": "Kindly suggest how to remove sign up option on the thingsboard white labelled login page. I have explored self registration option, but i couldn't see any option to disable sign up.",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/7344/comments",
    "author": "mubashirp",
    "comments": [
      {
        "user": "Backdraft007",
        "created_at": "2022-09-29T14:16:30Z",
        "body": "You can delte the self registration settings."
      },
      {
        "user": "mubashirp",
        "created_at": "2022-09-30T06:13:56Z",
        "body": "@Backdraft007  I have not given any settings under self registration to delete. It Is completely blank, also the delete button is disbaled. I checked under self registration to find any option to disable sign up option on the white labelled login page, but I couldn't find any options.\r\nCan you kindly suggest how we can remove sign up option on the login page.\r\n\r\n\r\n"
      },
      {
        "user": "Civilduino",
        "created_at": "2022-10-01T22:46:34Z",
        "body": "Basically I want to remove this div from the login webpage.\r\n\r\n`<div _ngcontent-hfr-c211=\"\" fxlayout=\"row\" class=\"no-account-section\" style=\"flex-direction: row; box-sizing: border-box; display: flex;\"><span _ngcontent-hfr-c211=\"\" translate=\"\" class=\"no-account-message\">Do not have an account?</span><a _ngcontent-hfr-c211=\"\" routerlink=\"/signup\" href=\"/signup\">Sign up</a></div>`"
      },
      {
        "user": "dhaval2017",
        "created_at": "2022-10-02T02:14:05Z",
        "body": "Did you tried to use css?"
      },
      {
        "user": "Civilduino",
        "created_at": "2022-10-02T11:26:44Z",
        "body": "I tried CSS and it \"works\". I could not hide the main `div` using the `class=\"no-account-section\"` because I see that the display options are giving explicitly in the `div` itself, overriding the class?\r\n\r\nI could hide the `class=\"no-account-message\"` and the `<a>` element with this code:\r\n\r\n```\r\n.no-account-message{\r\n    display: none;\r\n}\r\n\r\na[href^=\"/signup\"] {\r\n  display: none;\r\n}\r\n```\r\n\r\n**Update1**\r\n\r\nI think I figured out a more simple way, using:\r\n```\r\n.no-account-section{\r\n    visibility: hidden;\r\n}\r\n```\r\n\r\nThanks @dhaval2017 for the idea and hope it helps :)"
      }
    ]
  },
  {
    "number": 7160,
    "title": "Can we use authService with or without $injector inside the custom widget?",
    "created_at": "2022-08-27T06:28:08Z",
    "closed_at": "2022-11-05T11:47:48Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/7160",
    "body": "**Component**\r\n * UI\r\n * Generic\r\n\r\n**Description**\r\nCan we use authService inside the custom widget?\r\n\r\n**Environment**\r\n * ThingsBoard: PE and CE\r\n\r\n\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/7160/comments",
    "author": "dhaval2017",
    "comments": [
      {
        "user": "devaskim",
        "created_at": "2022-08-28T12:10:10Z",
        "body": "```\r\nlet authService = self.ctx.$scope.$injector.get(self.ctx.servicesMap.get('authService '));\r\n```"
      }
    ]
  },
  {
    "number": 6789,
    "title": "[Question] Add user to multiple groups (PE)",
    "created_at": "2022-06-22T11:20:43Z",
    "closed_at": "2022-06-22T14:58:32Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/6789",
    "body": "**Component**\r\n\r\n * UI\r\n\r\n**Description**\r\nPE user guide states that \"One user can simultaneously belong to several user groups\"\r\nHow it is possible to manage user<->relationship ?\r\n\r\n**Environment**\r\n * OS:  any\r\n * ThingsBoard: 3.2.2 PE\r\n * Browser: any\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/6789/comments",
    "author": "ganzuoni",
    "comments": [
      {
        "user": "Backdraft007",
        "created_at": "2022-06-22T14:10:13Z",
        "body": "You can mark a user an then you can click on the rounded + (Add to group) in the right top corner."
      }
    ]
  },
  {
    "number": 6738,
    "title": "Custom Validator  on FormArray-level prevents submit in custom action?",
    "created_at": "2022-06-17T09:53:57Z",
    "closed_at": "2024-05-14T14:52:13Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/6738",
    "body": "I've managed to include a custom validator into my form within a custom-action with html-template.\r\nFor this, I've simply defined a class and created an object from it:\r\n\r\n```\r\n    class customValidator {\r\n        constructor(){\r\n            this.isModelValid=true;\r\n        }\r\n        validate(c){        \r\n            let vals = c.value.map(item=>item.field2);\r\n            let sum = vals.reduce((previousValue, currentValue) => previousValue + currentValue,0);\r\n            return sum != 100 ? {'adduperror':true}: {'adduperror':false};\r\n        }\r\n        \r\n    }\r\n    vm.addupValidator= new customValidator();\r\n```\r\n\r\nThis validator was added to the fb.array-method of the instance.\r\n\r\n```\r\n     vm.addEntityFormGroup = vm.fb.group({\r\n     entityName: [''],\r\n     entityType: ['DEVICE'],\r\n     entityLabel: [null],\r\n\r\n     // similar to how relations-list is constructed\r\n     myarr: vm.fb.array([     vm.fb.group({\r\n        field1: [null, [vm.validators.required]],\r\n        field2 [null, [vm.validators.required,\r\n                      vm.validators.pattern(/^[0-9][0-9]?$|^100$/),\r\n                      ]]\r\n     })],[vm.addupValidator])\r\n     \r\n    });\r\n```\r\nValidation does indeed work as expected. However, the validator somehow doesn't allow me to submit the form (greyed out submit button)\r\n\r\nWhat am I missing?\r\nIs there another method I need to add to my validator class?",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/6738/comments",
    "author": "eeitnn",
    "comments": [
      {
        "user": "devaskim",
        "created_at": "2022-06-17T10:20:04Z",
        "body": "Validator should return not an object but `null` in case of no error."
      },
      {
        "user": "clemjrt",
        "created_at": "2023-03-27T14:55:14Z",
        "body": "Can you please provide the HTML of your custom widget ?\r\nI am facing some issues while using FormArray in a FormControl. \r\nTy by advance."
      }
    ]
  },
  {
    "number": 6622,
    "title": "[Question] How to specify sortOrder from custom widget",
    "created_at": "2022-06-01T13:08:04Z",
    "closed_at": "2022-06-01T14:33:02Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/6622",
    "body": "**Component**\r\n\r\n * UI\r\n\r\n**Description**\r\nI try to specify a sortOrder into a pageLink to get my results sorted (in this case devices sorted by name).\r\n\r\n**Environment**\r\n * OS:  name and version\r\n * ThingsBoard: 3.1 PE\r\n * Browser: Firefox\r\n\r\nWhen developing custom widget you can request devices assigned to a certain customer using this call:\r\n`self.ctx.deviceService.getCustomerDevices(customerId, pageLink).subscribe(....`\r\n\r\nThis works fine with default pageLink that you obtain like this:\r\n\r\n`self.ctx.pageLink()`; \r\n\r\nor even like this \r\n\r\n`self.ctx.pageLink(200, 0, '', null);  `\r\n\r\nwhere 200 is the max page size, 0 is the current page, '' is the search string and I guess last parameter is the sortOrder.\r\n\r\nNow I don't know how to specify sortOrder. The closest I got was with this:\r\n```\r\n       var pl = self.ctx.pageLink(200, 0, '', null);\r\n       pl['sortOrder'] = {};\r\n       pl.sortOrder['direction'] = 'ASC';\r\n       pl.sortOrder['key'] = {};\r\n       pl.sortOrder.key['key'] = 'name';\r\n       pl.sortOrder.key['type'] = 'ENTITY_FIELD';\r\n```\r\n\r\nwhich succeed to inject sortOrder in the request but not the sortProperty.\r\n\r\n/devices?pageSize=200&page=0&sortProperty=undefined&sortOrder=ASC&type=\r\n\r\nLogically resulting in a 500 server error with that error:\r\n\r\n`org.hibernate.QueryException: could not resolve property: undefined of: org.thingsboard.server.dao.model.sql.DeviceEntity [SELECT d FROM org.thingsboard.server.dao.model.sql.DeviceEntity d WHERE d.tenantId = :tenantId AND d.customerId = :customerId AND LOWER(d.searchText) LIKE LOWER(CONCAT(:searchText, '%')) order by d.undefined asc]; nested exception is java.lang.IllegalArgumentException: org.hibernate.QueryException: could not resolve property: undefined of: org.thingsboard.server.dao.model.sql.DeviceEntity [SELECT d FROM org.thingsboard.server.dao.model.sql.DeviceEntity d WHERE d.tenantId = :tenantId AND d.customerId = :customerId AND LOWER(d.searchText) LIKE LOWER(CONCAT(:searchText, '%')) order by d.undefined asc]`\r\n\r\nSo what is the proper way of performing this request with sort order on a field?",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/6622/comments",
    "author": "bbrenne",
    "comments": [
      {
        "user": "devaskim",
        "created_at": "2022-06-01T14:20:06Z",
        "body": "Try `self.ctx.pageLink(200, 0, '', {property: 'YOUR_KEY_NAME', direction: 'ASC'});`"
      }
    ]
  },
  {
    "number": 6547,
    "title": "How to set device label in the gateway?",
    "created_at": "2022-05-13T07:56:10Z",
    "closed_at": "2022-05-17T07:38:58Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/6547",
    "body": "Hi\uff0c Is there any way to set device label when send telemetry in gateway?",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/6547/comments",
    "author": "xiddjp",
    "comments": [
      {
        "user": "devaskim",
        "created_at": "2022-05-13T11:25:48Z",
        "body": "No, only name and type"
      }
    ]
  },
  {
    "number": 6527,
    "title": "How to show date and time with the value in the Simple card widget?",
    "created_at": "2022-05-05T10:47:36Z",
    "closed_at": "2022-06-01T12:25:55Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/6527",
    "body": "I am using the Simple Card widget to show the values but I also want to show the timestamp/ time in the dd-mm-yy hh-mm format.\r\nWhen the telemetry doesn't have any latest data the client is not able to differentiate whether it is latest or old data. Need timestamp to differentiate it.\r\n\r\nHow to show both the value and the time?\r\n\r\nI'm using Thingsboard version 3.3.2 \r\n\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/6527/comments",
    "author": "hetvishah08",
    "comments": [
      {
        "user": "ribera01",
        "created_at": "2022-05-06T12:13:55Z",
        "body": "You can put the same attribute with post-processing function \"return new Date(time).toLocaleString();\""
      },
      {
        "user": "devaskim",
        "created_at": "2022-05-07T14:43:23Z",
        "body": "According to source code of the widget @hetvishah08 asked it can show only single value.\r\nAs @ribera01 suggested you can add timestamp with post-processing function, for example:\r\n```\r\nreturn value + ' / ' + new Date(time).toLocaleString();\r\n```\r\nwhere *value* - is your telemetry value"
      },
      {
        "user": "hetvishah08",
        "created_at": "2022-05-11T11:41:36Z",
        "body": "How to change the font size and font weight of value and time? Is it possible in post-processing function or in widget style? \r\n\r\nI tried using fontSize in widget style and it didn't reflect any changes.\r\n\r\nAlso tried fontsize() in post processing. It works in card with text and not with numeric ones. They keep on loading. What is the issue?"
      },
      {
        "user": "devaskim",
        "created_at": "2022-05-11T15:48:52Z",
        "body": "Post-processing function cannot tune style.\r\nFont size of this widget has been calculated based on widget width and height. So to change it you may patch source code of this widget in *Widget Library* -> *Cards bundle* -> *Simple card* and save it as new widget."
      }
    ]
  },
  {
    "number": 6355,
    "title": "[Question] How can thingsboard gateway connect multiple OPC servers?",
    "created_at": "2022-04-01T06:17:56Z",
    "closed_at": "2022-04-02T03:15:42Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/6355",
    "body": "The usage scenario is as follows: each device has an independent OPC server. Now I can correctly collect the device through the thingsboard gateway, but opcua In the configuration of JSON, the address of an OPC server corresponding to each device cannot be configured.\r\nIn the seemingly TB configuration, the \"opc-ua\" scenario only supports one server corresponding to multiple devices.\r\nHow can I configure the gateway to support one configuration and access all devices?\r\n\r\nI need to configure an array \"server\"\uff1f\r\nor\r\nI need to configure multiple \"opcua. json\"\r\n\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/6355/comments",
    "author": "bggmjxh",
    "comments": [
      {
        "user": "devaskim",
        "created_at": "2022-04-01T11:21:35Z",
        "body": "You need to move this question to thingsboad-gateway project.\r\nBut I try to answer. You can create multiple configuration files opcua1. json, opcua2. json, opcua3. json and link each of them to corresponding OPC UA connector in the gateway configuration file. For example:\r\n```yaml\r\nconnectors:\r\n  -\r\n    name: 1 OPC\r\n    type: opcua\r\n    configuration: opcua1.json\r\n  -\r\n    name: 2 OPC\r\n    type: opcua\r\n    configuration: opcua2.json\r\n```"
      }
    ]
  },
  {
    "number": 6187,
    "title": "[Question] Show Button in Entities Table widget depending on attribute value of entity",
    "created_at": "2022-03-02T15:00:34Z",
    "closed_at": "2022-03-03T08:20:22Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/6187",
    "body": "Hello,\r\n\r\nI have an Entities table widget which displays all my Customers.\r\nIf some Customers are Service Providers, they have an boolean attribute \"is_service_provider\" equal to true. \r\nThis attribute is false otherwise.\r\nI would like to show or hide a button depending on the value of the attribute \"is_service_provider\".\r\nI have tried this code in the show/hide function of button but it does not work.\r\n\r\n```\r\n let $injector = widgetContext.$scope.$injector;\r\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\r\n\r\nattributeService.getEntityAttributes(data.id, 'SERVER_SCOPE', ['is_service_provider']).subscribe(\r\n                   function (attributes) {\r\n\t\t\t\tif(attributes[0]) {\r\n\t\t\t\t\treturn attributes[0].value;\r\n\t\t\t\t}   \r\n\t\t  }\r\n);\r\n```\r\n\r\nIs it because the return is inside the subscribe ?\r\nIs there any other way to do what I want ?\r\nBest Regards,\r\n\r\nLucas",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/6187/comments",
    "author": "lucasKapf",
    "comments": [
      {
        "user": "vparomskiy",
        "created_at": "2022-03-02T18:21:34Z",
        "body": "In your example, you return Observable instead of boolean value.\r\nThe easiest option is to add the field 'is_service_provider' in the widget datasource. And in show/hide function check it directly. Something like :\r\n\r\n> return data && data.is_service_provider;"
      },
      {
        "user": "lucasKapf",
        "created_at": "2022-03-03T08:20:22Z",
        "body": "Hello @vparomskiy thank you very much for your quick answer. I achieved it by doing what you said.\r\nI have just put \r\n`return data && data.is_service_provider === \"true\"`\r\nOtherwise it just checks if the attribute is_service_provider exists."
      }
    ]
  },
  {
    "number": 6053,
    "title": "Is it safe to use Delay Rule Node or Do I need to use something else ?",
    "created_at": "2022-02-08T09:05:50Z",
    "closed_at": "2022-02-09T13:37:07Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/6053",
    "body": "Hello,\r\n\r\nI have created a RuleChain that is triggered when attributes are updated. This RuleChain makes an API call to nominatim and get the latitude and longitude from an adress and a city in the attributes of the asset.\r\nI also have a dashboard which can create assets for customers. Those asset are of two types : building and equipment.\r\nWhat I try to do is to have a Rule Chain which places the asset in the good asset group of the customer. I do this by using the \"add to group\" node, and I use it for each type of asset. I want the assets to be placed in the \"buildings\" and \"equipments\" asset groups.\r\nThe thing is sometimes it works, and sometimes it doesn't. But in the debug of the Rule Chain it tells Success everytime.\r\nI just saw that an asset group \"equipments\" was created at the root level of the tenant, but is empty. So it seems to mean that my asset is placed in this group, then is transfered in the \"all\" group of the customer assets.\r\n\r\nNote : I change the asset owner programmatically in my widget using custom action.\r\nThe code is this.\r\n\r\n```\r\nvm.save = function() {\r\n  vm.addEquipementFormGroup.markAsPristine();\r\n\t\tlet asset = {\r\n\t\t\tname: vm.addEquipementFormGroup.get('equipementName').value,\r\n\t\t\ttype: vm.addEquipementFormGroup.get('assetType').value,\r\n\t\t\tlabel: vm.addEquipementFormGroup.get('equipementName').value\r\n\t\t};\r\n        \r\n               assetService.saveAsset(asset).subscribe(\r\n                 function (asset) {\r\n\t\t\t\twidgetContext.rxjs.forkJoin([\r\n                                 saveAttributes(asset.id),\r\n\t\t\t\tsaveRelations(asset.id)\r\n\t\t\t\t]).subscribe(\r\n                                   function () {\r\n                                                //The owner is the client in which I am located in the dashboard\r\n\t\t\t\t\t\tvar owner = widgetContext.stateController.stateObject[1].params.entityId;\r\n\t\t\t\t\t\tentityGroupService.changeEntityOwner(owner,asset.id).subscribe(\r\n\t\t\t\t\t\t\tfunction () {\r\n\t\t\t\t\t\t\t\twidgetContext.updateAliases();\r\n\t\t\t\t\t\t\t\tvm.dialogRef.close(null);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n                                 }\r\n\t\t\t    );\r\n              }\r\n           );\r\n  };\r\n```\r\n\r\nBest regards,\r\n\r\nLucas\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/6053/comments",
    "author": "lucasKapf",
    "comments": [
      {
        "user": "lucasKapf",
        "created_at": "2022-02-08T10:30:32Z",
        "body": "I added a Customer Detail Node in my Rule Chain : it seems that sometimes my asset is assigned to a Customer, and sometimes it isn't. I saw in my Root Rule Chain that the message type OWNER_CHANGED seems to happen sometimes before the message type ATTRIBUTES_UPDATED, and sometimes after. I don't know how to make the change of owner happen everytime before the update of the attributes ? \r\n\r\nDo I have to use the \"Delay\" Rule Node even if it is deprecated ? The two events seems to be only one second apart."
      },
      {
        "user": "volodymyr-babak",
        "created_at": "2022-02-09T12:38:52Z",
        "body": "@lucasKapf \r\nI would recommend having a single trigger in place - OWNER_CHANGED or ATTRIBUTES_UPDATED.\r\nYou cannot guarantee the order of the messages in your case, even with the usage of the Delay node.\r\nSo you should trigger **REST API Call** and **Add to group** nodes only on OWNER_CHANGED events.\r\n"
      }
    ]
  },
  {
    "number": 5689,
    "title": "[Question] how to setup a staging environment in clustered mode - licence key conflict",
    "created_at": "2021-12-06T16:51:43Z",
    "closed_at": "2021-12-08T14:48:11Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/5689",
    "body": "**Component**\r\n * Installation\r\n\r\n**Description**\r\nI'm trying to setup a staging environment in my company to test changes for my tenants before applying them on the production environment.\r\nBoth environments are running TB PE 3.3.1 with hybrid storage (postgres+cassandra).\r\nI want the staging environment to be a copy of the production environment data-wise, so I purchased another TB licence to run the staging environment, then tried to dump & restore the postgres database from the production instance on the staging instance.\r\nHowever the production database somehow contains the licence information embedded in it.\r\nNow my staging environment does not start and I have no idea how to reapply my 2nd license key while keeping the rest of the data.\r\n\r\nHow should I proceed ?\r\n\r\n**Environment**\r\n * OS:  ubuntu\r\n * ThingsBoard: 3.3.1PE running on docker-compose\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/5689/comments",
    "author": "ThomasPrioul",
    "comments": [
      {
        "user": "ashvayka",
        "created_at": "2021-12-08T10:23:47Z",
        "body": "There is no license information in the database. All the license info is stored in the license.data file. Maybe you have copied the volumes (and not only the database). Then this is the root cause. Just\r\n1) shut down dev TB instance\r\n2) remove the license.data file\r\n3) make sure the correct license key is used.\r\n4) start it again."
      },
      {
        "user": "ThomasPrioul",
        "created_at": "2021-12-08T14:48:11Z",
        "body": "Thanks for your answer.\r\nI had probably corrupted something else, my TB instance was not starting and I had no license.data file at all.\r\nWhat I did was **remove the old instance from the license server**, reset everything and the staging instance came back to life.\r\nI had not copied the volume, I did a SQL dump from the running postgres container in production."
      }
    ]
  },
  {
    "number": 5508,
    "title": "Device Profile Alarm Rule - alarm severity cannot be change from Critical to Major",
    "created_at": "2021-11-07T07:58:07Z",
    "closed_at": "2021-11-08T08:10:35Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/5508",
    "body": "Consider the following device profile alarm rule:\r\ncreation condition 1: if device temperature > 4, create High Temperature alarm with Critical severity\r\ncreation condition 2: if device temperature > 0 and temperature <=4, create High Temperature alarm with Major severity\r\nclear condition: if device temperature < 0\r\n\r\nTest result:\r\n1. device temperature = 2, new alarm with Major severity is created => OK\r\n2. device temperature = 5, alarm is updated with Critical Severity => OK\r\n3. device temperature = 2 again, no update to alarm severity => NOT OK\r\n4. device temperature = -1, alarm is cleared => OK\r\n\r\nQuestion: in step 3,  should the alarm be updated with severity set to Major?\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/5508/comments",
    "author": "sunyong-mwi",
    "comments": [
      {
        "user": "ashvayka",
        "created_at": "2021-11-08T07:58:29Z",
        "body": "It is currently implemented the way you described. For us, it seems logical and expected behavior. We assume the person who is configuring the rule is interested to know about the alarm caused by the \"maximum\" temperature. For example, if this is a fridge with something that can't be stored with temperature > 0. Then, if the temperature is -2 it is Major alarm, but if the temperature was +1, it is definitely critical, even if then, the temperature is back to -2. "
      }
    ]
  },
  {
    "number": 5445,
    "title": "[Question] HTML/Markdown card widget conditional display based on attributes",
    "created_at": "2021-10-27T03:01:06Z",
    "closed_at": "2021-12-01T21:12:53Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/5445",
    "body": "I have created a navigation menu bar using the HTML/Markdown card widget and it works great.\r\n\r\nI would like to control the visibility of some of the menu items based on my custom Server Attributes.\r\nfor example `if ${showTemperaturePage} == true` then display an object in the menu.\r\n\r\nI'm not sure how to put some java script into the widget to alter the visibility in CSS\r\n\r\nRegards\r\nGed\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/5445/comments",
    "author": "gednz",
    "comments": [
      {
        "user": "Backdraft007",
        "created_at": "2021-10-27T06:35:53Z",
        "body": "Hi,\r\nI think in markdown it is not possible.\r\nMaybe you can use the \"data post-processing-function\" of the attribute. If its true, return your markdown for menu-item, else return nothing.\r\n"
      },
      {
        "user": "vvlladd28",
        "created_at": "2021-10-27T09:58:02Z",
        "body": "Hi @gednz,\r\nYou can control show/hide menu items using the functionality markdown widget:\r\n1. You need an activated checkbox - \"Use markdown text function\" in the advance setting widget\r\n2. In the markdown text function, your need to write code to generate markdown text. For example: \r\n```javascript\r\nlet menu = \"\";\r\nif (data[0].showTemperaturePage == true) {\r\n menu += \"* First item\";   \r\n}\r\nmenu += \"* Second item\"; // always show this item  \r\nreturn menu;\r\n```\r\n"
      },
      {
        "user": "gednz",
        "created_at": "2021-10-28T04:38:18Z",
        "body": "Hi @vvlladd28 \r\n\r\nI haven't tried this yet as the other way worked this time, however I'm interested in this method for more complex logic involving more than one attribute.\r\n\r\nIf we use the \"markdown text function\" can we still style it with CSS and HTML. I got the impression it was one or the other?\r\n\r\nRegards\r\nGed"
      }
    ]
  },
  {
    "number": 4863,
    "title": "[Question] Close opened MQTT connection",
    "created_at": "2021-07-05T15:14:19Z",
    "closed_at": "2021-09-30T13:40:02Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/4863",
    "body": "**Component**\r\n\r\n * Generic\r\n\r\n**Description**\r\n\r\nSuppose we have a broken device that is sending a huge amount of data. I want to close the current connection on a specific device.\r\n\r\nI'm not finding a way to close an open connection, and I would like to know if is possible.\r\n\r\nThank you in advance\r\n\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/4863/comments",
    "author": "fraucamidokura",
    "comments": [
      {
        "user": "KenSense",
        "created_at": "2021-07-12T09:43:27Z",
        "body": "If you make a new connection with the same Client ID the current one will be closed\r\n(it doesn't prevent the device to do the same reconnect and kick you off)\r\n\r\nI guess in that situation I would change the device credential settings I think so It can't keep sending data, only try to connect..\r\nIt will depend on your device firmware how long it tries before giving up."
      },
      {
        "user": "fraucamidokura",
        "created_at": "2021-07-12T10:03:42Z",
        "body": "> If you make a new connection with the same Client ID the current one will be closed\r\n> (it doesn't prevent the device to do the same reconnect and kick you off)\r\n> \r\n> I guess in that situation I would change the device credential settings I think so It can't keep sending data, only try to connect..\r\n> It will depend on your device firmware how long it tries before giving up.\r\n\r\nYou are right. Changing the credentials does stop the current device session. I may check that wrong the first time. So changing the credentials could be a valid solution to my problem.\r\n"
      }
    ]
  },
  {
    "number": 4817,
    "title": "[Question] Button Action Code to Post latest telemetry value to another key?",
    "created_at": "2021-06-29T12:43:15Z",
    "closed_at": "2021-07-08T15:56:17Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/4817",
    "body": "**Component**\r\nThingsboard Webpage\r\n * UI\r\nWidget Actions\r\n\r\n**Description**\r\nI want to copy the value of the telemetry key distributionImage to distributionRefImage when they press the action button.\r\n\r\nI don't have much more than starting with \r\n\r\n_let $injector = widgetContext.$scope.$injector;\r\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));_\r\n\r\nThen I assume this but I don't know how I should translate that to javascript??\r\n(Get latest value and post it again on other key)\r\n\r\n_var sourcekey = 'distributionImage'\r\nvalue = get /api/plugins/telemetry/{entityType}/{entityId}/values/timeseries{?keys,useStrictDataTypes}_ \r\n\r\n_var targetkey = 'distributionRefImage'\r\npost /api/plugins/telemetry/{entityType}/{entityId}/timeseries/{scope}_ \r\n\r\nThanks\r\n\r\n**Environment**\r\n * OS:  Windows 10\r\n * ThingsBoard: 3.2.2\r\n\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/4817/comments",
    "author": "KenSense",
    "comments": [
      {
        "user": "KenSense",
        "created_at": "2021-07-01T07:43:39Z",
        "body": "I see I may need to use getEntityTimeseries and saveEntityTimeseries from class AttributeService\r\nAn example would be nice!"
      },
      {
        "user": "KenSense",
        "created_at": "2021-07-08T07:28:52Z",
        "body": "I tried to simplify it by writing the code in the rule chain and then trigger that code with a server Attribute.\r\nSo on Action I only need to set an predefined server Attribute (no pop-up)\r\n\r\nBut it doesn't work, do you see why? (is there some way to debug to see what fails?)\r\n```\r\nlet $injector = widgetContext.$scope.$injector;\r\nlet attributeService = $injector.get(widgetContext\r\n    .servicesMap.get('attributeService'));\r\n\r\nsaveAttributes(entityId);\r\n\r\nfunction saveAttributes(entityId) {\r\n    let attributesArray = [];\r\n    attributesArray.push({\r\n        key: \"setRefTrigger\",\r\n        value: true\r\n    });\r\n    if (attributesArray.length > 0) {\r\n        return attributeService.saveEntityAttributes(\r\n            entityId, \"SERVER_SCOPE\",\r\n            attributesArray);\r\n    } else {\r\n            return false;\r\n    }\r\n}\r\n```\r\n\r\nThanks"
      },
      {
        "user": "ChantsovaEkaterina",
        "created_at": "2021-07-08T14:16:27Z",
        "body": "Hello, @KenSense \r\nThe code below should help you. It is important to call _subscribe_, without this nothing will work.\r\n```\r\nsaveAttributes(entityId).subscribe(() => {\r\n//    your code\r\n});\r\n\r\nfunction saveAttributes(entityId) {\r\n    let attributesArray = [{\r\n        key: \"setRefTrigger\",\r\n        value: true\r\n    }];\r\n    return attributeService.saveEntityAttributes(\r\n        entityId, \"SERVER_SCOPE\",\r\n        attributesArray);\r\n}\r\n```\r\n"
      }
    ]
  },
  {
    "number": 4614,
    "title": "how to use ctx attribute service to call getEntityTimeseries ",
    "created_at": "2021-05-22T14:57:32Z",
    "closed_at": "2021-05-24T13:16:40Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/4614",
    "body": "**Component**\r\n\r\n<!-- Choose one of the following and delete all others. -->\r\n * Generic\r\n\r\n**Description**\r\n Hi,\r\nI want to call ctx.attributeservice.getEntityTimeseries  to get sum of timseries as a column in EntityTable-widget. so I called that in \r\nadvanced javascript section of widget column.\r\n\r\n\r\n**_e = entity.id; //entityId\r\nt = [\"lat\"]; //keys keys=gas,temperature\r\nn = 1479735870785; //startTs\r\ni = 1479735871858; //endTs\r\na = 100; //limit\r\no = \"SUM\" //agg\r\nu = 60000; //interval\r\np = \"AVG\"; //orderBy\r\nd = false; //useStrictDataTypes\r\nm = 1; //config\r\n\r\nsum= ctxmain.attributeService.getEntityTimeseries(\r\n    entityId = e, keys = t, startTs = n, endTs = i,\r\n    agg = o, interval = u , limit=a);        \r\nreturn sum;_**\r\n\r\n but i am witnessed this result:\r\n\r\n**_e {_isScalar: false, source: e, operator: e}\r\noperator: e {project: \u0192, thisArg: undefined}\r\nsource: e {_isScalar: false, source: e, operator: e}\r\n_isScalar: false\r\n__proto__: Object_**\r\n\r\ni expect to get a number or list of number as output, please give me a solution\r\nthanks in advance\r\n\r\n**Environment**\r\n<!-- Add information about your environment and ThingsBoard version if applicable -->\r\n\r\n * ThingsBoard: CE \r\n\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/4614/comments",
    "author": "HNKSara",
    "comments": [
      {
        "user": "ChantsovaEkaterina",
        "created_at": "2021-05-24T08:20:24Z",
        "body": "Hello, @HNKSara \r\nHope, code below will help you. Also, please note, that the _getEntityTimeseries_ method is asynchronous.\r\n```\r\nconst attributeService = self.ctx.$scope.$injector.get(self.ctx.servicesMap.get('attributeService'));\r\nattributeService.getEntityTimeseries(entityId, keys, startTs, endTs, limit, agg, interval).subscribe((data) => {\r\n    console.log(data);\r\n})\r\n```"
      },
      {
        "user": "HNKSara",
        "created_at": "2021-05-24T13:13:34Z",
        "body": "Hi, @ChantsovaEkaterina\r\n**thanks, it works fine.**\r\nbut there was some edit:\r\n\"self\" was removed:\r\nconst attributeService = ctx.$scope.$injector.get(ctx.servicesMap.get('attributeService'));\r\nattributeService.getEntityTimeseries(entityId, keys, startTs, endTs, limit, agg, interval).subscribe((data) => {\r\n    console.log(data);\r\n})\r\n\r\n\r\n**the result is here:**\r\n{ workload: Array(1) }\r\nworkload: Array(1)\r\n0: {ts: 1620033938000, value: \"768\"}\r\nlength: 1\r\n__proto__: Array(0)\r\n__proto__: Object\r\n\r\n\r\n"
      }
    ]
  },
  {
    "number": 4544,
    "title": "REST API call 'getCustomerDevices' has changed",
    "created_at": "2021-05-06T09:44:33Z",
    "closed_at": "2021-05-06T10:33:46Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/4544",
    "body": "**Component**\r\n\r\n<!-- Choose one of the following and delete all others. -->\r\n * Installation\r\n * REST API\r\n\r\n**Description**\r\nREST API call 'getCustomerDevices' has changed after updating TB from **v2.4.3** to **v.3.2.2**\r\nIn v2.4.3. it was:\r\n_get /api/customer/{customerId}/devices{?type,textSearch,idOffset,textOffset,limit}_\r\n\r\nIn v3.2.2 it is\r\n_get /api/customer/{customerId}/devices{?type,textSearch,sortProperty,sortOrder,pageSize,page}_ \r\n\r\nThe problem is that with v2.4.3 API I was able to get a list of all devices that are assigned to the customer. With v.3.2.2 I have to iterate through the pages to get a complete list of assigned devices. \r\n\r\nWe use our own developped MES to show devices that are assigned to specific customers which is not possible anymore. \r\nIs there a way to use the old REST API version from v2.4.3 with the new v3.2.2?\r\n\r\n**Environment**\r\n<!-- Add information about your environment and ThingsBoard version if applicable -->\r\n * OS:  Kybernetes installation\r\n * ThingsBoard: 3.2.2\r\n * Browser: Firefox\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/4544/comments",
    "author": "achenje",
    "comments": [
      {
        "user": "Backdraft007",
        "created_at": "2021-05-06T09:58:27Z",
        "body": "Try to set pageSize=1000 and page=0"
      }
    ]
  },
  {
    "number": 4308,
    "title": "[Question] make customer vie group dashboard puplic",
    "created_at": "2021-03-25T17:25:38Z",
    "closed_at": "2021-03-26T21:24:35Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/4308",
    "body": "**Component**\r\n\r\n<!-- Choose one of the following and delete all others. -->\r\n * Rule Engine\r\n\r\n**Description**\r\nHi, I like to organize dashboards and devices in Customer Groups.\r\nIs there a possibility to make a puplic dashboard / puplic device? I can\u00b4t find the \"make puplic\" button and don\u00b4t find a workaround.\r\n\r\nCheers!\r\n\r\n**Environment**\r\n<!-- Add information about your environment and ThingsBoard version if applicable -->\r\n * OS:  Ubuntu 18\r\n * ThingsBoard: Professional (Version...have to ask our admin...)\r\n * Browser: FireFox 78.9.0esr\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/4308/comments",
    "author": "Mirjka",
    "comments": [
      {
        "user": "vvlladd28",
        "created_at": "2021-03-26T10:23:21Z",
        "body": "HI @Mirjka,\r\nIn TB PE, you can't do make a public dashboard because TB PE supports only the public dashboard group/device group. In your case, your need to create a new dashboard group and added a dashboard that you want to make public, and then make this group public."
      },
      {
        "user": "Mirjka",
        "created_at": "2021-03-26T12:54:30Z",
        "body": "Hi @ashvayka,\r\nthanks for youre advice. In that case, I have to organize the devices also outside the customer group to make them puplic aswell, don\u00b4t I?"
      },
      {
        "user": "vvlladd28",
        "created_at": "2021-03-26T15:28:33Z",
        "body": "Hi @Mirjka,\r\nNo, you can organize a group of devices at the client and make them public"
      }
    ]
  },
  {
    "number": 3923,
    "title": "REST API Properties",
    "created_at": "2021-01-08T10:06:08Z",
    "closed_at": "2024-05-22T10:17:07Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3923",
    "body": "Hello All,\r\n\r\n    What is sort Property in Swagger URL REST API Link.\r\n\r\n /api/user/devices{?type,textSearch,sortProperty,sortOrder,pageSize,page}\r\n\r\nWhat property to be set for \r\ntextSearch and sortProperty",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3923/comments",
    "author": "nmahale10",
    "comments": [
      {
        "user": "vvlladd28",
        "created_at": "2021-01-12T08:29:48Z",
        "body": "Hi @nmahale10,\r\n\r\ntextSearch [String] - name to find device\r\nsortProperty [String] - device name property, for sorting devices in array response"
      },
      {
        "user": "nmahale10",
        "created_at": "2021-01-12T08:38:52Z",
        "body": "Can you please explain what is device Name Property.\r\n\r\nIs their any other way to get All devices of Particular tenant."
      },
      {
        "user": "vvlladd28",
        "created_at": "2021-01-12T09:46:01Z",
        "body": "For example device Name Property: name, label, type, createdTime, etc.\r\nGet all devices, current tenant, used API: /api/user/devices?pageSize=1000&page=0\r\n "
      }
    ]
  },
  {
    "number": 3848,
    "title": "ThingsBoard Create Device with custom Access token",
    "created_at": "2020-12-14T12:18:58Z",
    "closed_at": "2020-12-17T07:55:30Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3848",
    "body": "**_### hi all\r\n\r\ni would like to create new device from admin device widget and change its access token while creation.\r\ncode i am using_**\r\n\r\nlet $injector = widgetContext.$scope.$injector;\r\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\r\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\r\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\r\n\r\nopenAddDeviceDialog();\r\n\r\nfunction openAddDeviceDialog() {\r\n    customDialog.customDialog(htmlTemplate, AddDeviceDialogController).subscribe();\r\n}\r\n\r\nfunction AddDeviceDialogController(instance) {\r\n    let vm = instance;\r\n    \r\n    vm.addDeviceFormGroup = vm.fb.group({\r\n      deviceName: ['', [vm.validators.required]],\r\n      deviceType: ['', [vm.validators.required]],\r\n      deviceLabel: [''],\r\n      attributes: vm.fb.group({\r\n          latitude: [null],\r\n          longitude: [null]\r\n      })      \r\n    });\r\n    \r\n    vm.cancel = function() {\r\n        vm.dialogRef.close(null);\r\n    };\r\n    \r\n    vm.save = function() {\r\n        vm.addDeviceFormGroup.markAsPristine();\r\n        let device = {\r\n            name: vm.addDeviceFormGroup.get('deviceName').value,\r\n            type: vm.addDeviceFormGroup.get('deviceType').value,\r\n            label: vm.addDeviceFormGroup.get('deviceLabel').value\r\n        };\r\n        let device2 = {\r\n            createdTime: 0,\r\n            credentialsId: \"string\",\r\n            credentialsType: \"ACCESS_TOKEN\",\r\n            credentialsValue: \"123\",\r\n            id:\"string\"\r\n            \r\n            \r\n        };\r\n        deviceService.saveDevice(device).subscribe(\r\n            function (device) {\r\n                saveAttributes(device.id).subscribe(\r\n                    function () {\r\n                        widgetContext.updateAliases();\r\n                        vm.dialogRef.close(null);\r\n                    }\r\n                );\r\n            }\r\n        );\r\n       deviceService.saveDeviceCredentials(device2).subscribe();\r\n        \r\n           \r\n    }\r\n    function saveAttributes(entityId) {\r\n        let attributes = vm.addDeviceFormGroup.get('attributes').value;\r\n        let attributesArray = [];\r\n        for (let key in attributes) {\r\n            attributesArray.push({key: key, value: attributes[key]});\r\n        }\r\n        if (attributesArray.length > 0) {\r\n            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\r\n        } else {\r\n            return widgetContext.rxjs.of([]);\r\n        }\r\n    }\r\n}\r\n\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3848/comments",
    "author": "mm-1994",
    "comments": [
      {
        "user": "vvlladd28",
        "created_at": "2020-12-14T15:56:53Z",
        "body": "Hi @mm-1994,\r\n\r\nYou need to change the device save function:\r\n```\r\nvm.save = function() {\r\n    vm.addDeviceFormGroup.markAsPristine();\r\n    let device = {\r\n        name: vm.addDeviceFormGroup.get('deviceName').value,\r\n        type: vm.addDeviceFormGroup.get('deviceType').value,\r\n        label: vm.addDeviceFormGroup.get('deviceLabel').value\r\n    };\r\n    widgetContext.http.post('/api/device/credentials?accessToken=123', device).subscribe(\r\n        function (device) {\r\n            saveAttributes(device.id).subscribe(\r\n                function () {\r\n                    widgetContext.updateAliases();\r\n                    vm.dialogRef.close(null);\r\n                }\r\n            );\r\n        }\r\n    );\r\n}\r\n```\r\n"
      },
      {
        "user": "mm-1994",
        "created_at": "2020-12-15T08:18:57Z",
        "body": "Hi @vvlladd28 \r\nthanks so much for your help and quick response.\r\ni tried your code but when i create the device an error \"incorrect deviceId null\"\r\n_i am using device admin table_\r\nhere is my code\r\n\r\n`let $injector = widgetContext.$scope.$injector;\r\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\r\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\r\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\r\n\r\nopenAddDeviceDialog();\r\n\r\nfunction openAddDeviceDialog() {\r\n    customDialog.customDialog(htmlTemplate, AddDeviceDialogController).subscribe();\r\n}\r\n\r\nfunction AddDeviceDialogController(instance) {\r\n    let vm = instance;\r\n    \r\n    vm.addDeviceFormGroup = vm.fb.group({\r\n      deviceName: ['', [vm.validators.required]],\r\n      deviceType: ['', [vm.validators.required]],\r\n      deviceLabel: [''],\r\n      attributes: vm.fb.group({\r\n          latitude: [null],\r\n          longitude: [null]\r\n      })      \r\n    });\r\n    \r\n    vm.cancel = function() {\r\n        vm.dialogRef.close(null);\r\n    };\r\n    \r\n    vm.save = function() {\r\n        vm.addDeviceFormGroup.markAsPristine();\r\n        let device = {\r\n            name: vm.addDeviceFormGroup.get('deviceName').value,\r\n            type: vm.addDeviceFormGroup.get('deviceType').value,\r\n            label: vm.addDeviceFormGroup.get('deviceLabel').value\r\n        };\r\n        widgetContext.http.post('/api/device/credentials?accessToken=123', device).subscribe(\r\n            function (device) {\r\n                saveAttributes(device.id).subscribe(\r\n                    function () {\r\n                        widgetContext.updateAliases();\r\n                        vm.dialogRef.close(null);\r\n                    }\r\n                );\r\n            }\r\n        );\r\n    };\r\n    \r\n    function saveAttributes(entityId) {\r\n        let attributes = vm.addDeviceFormGroup.get('attributes').value;\r\n        let attributesArray = [];\r\n        for (let key in attributes) {\r\n            attributesArray.push({key: key, value: attributes[key]});\r\n        }\r\n        if (attributesArray.length > 0) {\r\n            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\r\n        } else {\r\n            return widgetContext.rxjs.of([]);\r\n        }\r\n    }\r\n}`"
      },
      {
        "user": "vvlladd28",
        "created_at": "2020-12-16T22:41:25Z",
        "body": "Hi @mm-1994,\r\nI had mistaken in URL API, this correct code:\r\n```\r\n widgetContext.http.post('/api/device?accessToken=123', device).subscribe(\r\n        function (device) {\r\n            saveAttributes(device.id).subscribe(\r\n                function () {\r\n                    widgetContext.updateAliases();\r\n                    vm.dialogRef.close(null);\r\n                }\r\n            );\r\n        }\r\n    );\r\n```"
      }
    ]
  },
  {
    "number": 3758,
    "title": "Is there a way to hide a widget based on device type?",
    "created_at": "2020-11-19T18:46:47Z",
    "closed_at": "2020-11-20T21:12:28Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3758",
    "body": "**Component**\r\nDashboard states\r\n\r\n * UI\r\nMultiple dashboard for devices\r\n\r\n**Description**\r\nIs there a way to hide a widget based on the device type that's clicked?  For Example I have an entity list widget with all my devices on my first landing page dashboard.  The user clicks on the device and it goes to a dashboard state with detailed info.  I have devices that are very similar but may or may not have an extra feature such as humidity.  So basically if I have a device with temperature and humidity I want to show the graphs of temperature and humidity when I click on that type of device.  If I have a device with only temperature the info dashboard should have no humidity graph.  \r\n\r\nIs the only way to do this with multiple dashboards?  The issue I have with that is there are several other widgets on the info page and if I make a change to one of those other widgets I now have to duplicate the change on the other dashboards....\r\n\r\n**Environment**\r\n * OS:  Windows Server 2016\r\n * ThingsBoard: 2.3.4\r\n * Browser: Chrome (latest version)",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3758/comments",
    "author": "sferguson-ISI",
    "comments": [
      {
        "user": "ChantsovaEkaterina",
        "created_at": "2020-11-20T08:14:35Z",
        "body": "Hello,\r\nThere is no option to hide a widget from a particular state but in your case, you could create a second state (not a new dashboard), and when clicking on a device in the list check its type and depending on this navigate to the needed state. As for widgets that should be the same for both states (only if they are completely the same including a datasource set, state entity for example), there is an ability to copy widget by link. If the widget copied by link, changes made to it in one state should be automatically propagated to another."
      },
      {
        "user": "jonrot1906",
        "created_at": "2020-11-20T17:14:46Z",
        "body": "Depending on your widgets, you could also apply a filter which will check for attribute or timeseries \"humidity\". E.g. applying an attribute filter \"Humidity\" with key name \"humidity\" you can set operation to \"ignore case\" if this attribute \"not contains\" a value (you leave the value line blank). Now if you have a widget where you want to display your humidity and temperature timeseries, simply create an extra datasource which will apply the filter for each device depending on your dashboard state."
      }
    ]
  },
  {
    "number": 3636,
    "title": "Issue with Label and Tooltip Functions at PE 3.1.1",
    "created_at": "2020-10-26T14:42:14Z",
    "closed_at": "2020-10-29T15:56:30Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3636",
    "body": "**Component**\r\n * UI\r\n\r\n**Environment**\r\n * OS:  Ubuntu 20\r\n * ThingsBoard: PE 3.1.1\r\n * Browser: Chrome\r\n\r\n**Description**\r\nHi Guys, I am trying to use Label Functions to customize my assets labels and colors at a Latest Value OpenStreetMap widget. At Dashboard Advanced Parameters tab, we have as default function the following. \r\n\r\nvar deviceType = dsData[dsIndex]['deviceType'];\r\nif (typeof deviceType !== undefined) {\r\n    if (deviceType == \"energy meter\") {\r\n        return '<span style=\"color:orange;\">${entityName}, ${energy:2} kWt</span>';\r\n    } else if (deviceType == \"thermometer\") {\r\n        return '<span style=\"color:blue;\">${entityName}, ${temperature:2} \u00b0C</span>';\r\n    }\r\n}\r\n\r\nSo, my doubts are:\r\n\r\n1) Which options are possible to read as dsData[dsIndex]? I mean, hoa can I get a list of possible keys?\r\n2) I tried to alter this function for assetType instead of deviceType, once my aliasses were created filtering my assets types, but it did not work. What I am trying to run is the following, but instead of create colors differenciation it is not returning any label for any asset. Without using label function the labels work fine (without any differenciation).\r\n\r\nvar assetType = dsData[dsIndex]['assetType'];\r\nif (typeof assetType !== undefined) {\r\n    if (assetType == \"ABC\") {\r\n        return '<span style=\"color:orange;\">${entityName}</span>';\r\n    } else if (assetType == \"DEF\") {\r\n        return '<span style=\"color:blue;\">${entityName}</span>';\r\n    }\r\n}\r\n\r\nThanks for your help sharing your tips and comments.",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3636/comments",
    "author": "FreddyHunter",
    "comments": [
      {
        "user": "ChantsovaEkaterina",
        "created_at": "2020-10-29T09:16:13Z",
        "body": "Hello,\r\nWhen using _dsData[dsIndex]_ you are able to get the value of any key, that you specified in the Datasources tab, in this way:\r\n_dsData[dsIndex]['targetKeyLabel']_.\r\nTo get the asset/device type you need to add the _\"type\"_ key (if your entity has attributes with the same name, it is important to select the correct key type - _entity field_). Then you will be able to use it in the label function by specifying _dsData[dsIndex]['Type']_ if you have not changed the default key label.\r\n"
      }
    ]
  },
  {
    "number": 3541,
    "title": "How to use Attribute data in Map tooltip widget?",
    "created_at": "2020-10-05T07:52:46Z",
    "closed_at": "2021-03-04T11:31:54Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3541",
    "body": "Hi guys\r\n\r\nI am trying to do some logic and to display attribute values in the map tooltip / map color function\r\n\r\nit works for timeseries data, but I cannot make it work for attributes:\r\n\r\nfor attribute key 'active' that is selected in the data source for the widget.\r\n\r\n\tvar active = dsData[dsIndex]['active'];\r\ndoesn't work\r\nwhile the same works for temperature time series in the data sources.\r\n\r\n\tvar temperature = dsData[dsIndex]['temperature'];\r\n\r\nWhat is the correct method here?\r\n\r\n@YevhenBondarenko ",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3541/comments",
    "author": "t0mZ4",
    "comments": [
      {
        "user": "ChantsovaEkaterina",
        "created_at": "2021-03-04T10:54:45Z",
        "body": "Hello, @t0mmyz7 \r\nThe approach you are using to get the attributes/timeseries values is correct.\r\nCould you check, please, if you are addressing attributes by the label, not by key name?"
      },
      {
        "user": "t0mZ4",
        "created_at": "2021-03-04T11:31:53Z",
        "body": "HI @ChantsovaEkaterina \r\n\r\nyou are correct, i try again and it does work, what made the difference was to use the value as a string and not boolean.\r\n\r\nbefore I was trying to use the value as boolean\r\n\r\nif (active == true) {}\r\n\r\nbut what works is actually if (active == \"true\")\r\n\r\n\r\nthanks for your reply"
      },
      {
        "user": "dhaval2017",
        "created_at": "2021-08-14T12:41:00Z",
        "body": "@bioshock2k please share the code"
      },
      {
        "user": "bioshock2k",
        "created_at": "2021-08-14T13:03:55Z",
        "body": "var state = dsData[dsIndex]['active'];\r\nvar usb = dsData[dsIndex]['vusb'];\r\n\r\nif(state=='false')\r\n{\r\n    res='red';\r\n}\r\nelse{\r\nif(usb==0.0){\r\n    res='blue';\r\n}\r\nelse{\r\n    res='green'\r\n}\r\n}\r\nreturn res;\r\n\r\nThe only way i got this to work is to translate the timeseries to an attribute.."
      }
    ]
  },
  {
    "number": 3448,
    "title": "[Question] Transform Payload in Rule Engine",
    "created_at": "2020-09-11T09:33:30Z",
    "closed_at": "2020-09-11T11:43:14Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3448",
    "body": "**Component**\r\n * Rule Engine\r\n\r\n**Description**\r\nI need to generate a new JSON in the Root Rule Chain, this new JSON is different from the input. I am using the script node to add new nodes.\r\n\r\nI need to add JSON node names with @, for example:\r\n\r\ninput message > { \"temperature\" : 24}\r\noutput message > { \"@temp\": 24}\r\n\r\nHow can achieve this?\r\n\r\n**Environment**\r\n * OS:  Ubuntu 18.04\r\n * ThingsBoard: 3.1.1\r\n * Browser: Chrome\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3448/comments",
    "author": "felixmondelo",
    "comments": [
      {
        "user": "Chabrol",
        "created_at": "2020-09-11T11:40:29Z",
        "body": "Something like this should work in an transformation script:\r\n```\r\nmsg[\"@temp\"] = msg.temperature;\r\ndelete msg.temperature;\r\n```\r\n"
      }
    ]
  },
  {
    "number": 3440,
    "title": "trying to --loaddemo in ubuntu giving syntax error while running schema-entities.sql for v3.1.1 is installation guide not updated?",
    "created_at": "2020-09-10T12:12:08Z",
    "closed_at": "2020-09-11T08:03:17Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3440",
    "body": "**Component**\r\n\r\n<!-- Choose one of the following and delete all others. -->\r\n * Installation\r\n\r\n**Description**\r\nTrying to loaddemo data for v3.1.1 as per ubuntu installation guide. its giving below error. same happening with docker installation as well. so i pulled v3.0.1 in docker which works fine.\r\n\r\nInstalling DataBase schema for entities...\r\nInstalling SQL DataBase schema part: schema-entities.sql\r\nUnexpected error during ThingsBoard installation!\r\norg.postgresql.util.PSQLException: The connection attempt failed.\r\n\r\n\r\n**Environment**\r\n * OS:  ubuntu 16.04.7 LTS\r\n * ThingsBoard: 3.1.1\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3440/comments",
    "author": "ravipras8",
    "comments": [
      {
        "user": "CooL16",
        "created_at": "2020-09-10T12:21:28Z",
        "body": "@ravipras8 please provide us with full log of an installation"
      },
      {
        "user": "ashvayka",
        "created_at": "2020-09-10T12:58:37Z",
        "body": "Due to the error: org.postgresql.util.PSQLException: The connection attempt failed.\r\nI suspect that connection parameters for postgresql are not correct. please share your thingsboard.conf"
      },
      {
        "user": "ravipras8",
        "created_at": "2020-09-10T13:28:09Z",
        "body": "cat /etc/thingsboard/conf/thingsboard.conf\r\n\r\nexport JAVA_OPTS=\"$JAVA_OPTS -Dplatform=deb -Dinstall.data_dir=/usr/share/thingsboard/data\"\r\nexport JAVA_OPTS=\"$JAVA_OPTS -Xloggc:/var/log/thingsboard/gc.log -XX:+IgnoreUnrecognizedVMOptions -XX:+HeapDumpOnOutOfMemoryError -XX:+PrintGCDetails -XX:+PrintGCDateStamps\"\r\nexport JAVA_OPTS=\"$JAVA_OPTS -XX:+PrintHeapAtGC -XX:+PrintTenuringDistribution -XX:+PrintGCApplicationStoppedTime -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=10\"\r\nexport JAVA_OPTS=\"$JAVA_OPTS -XX:GCLogFileSize=10M -XX:-UseBiasedLocking -XX:+UseTLAB -XX:+ResizeTLAB -XX:+PerfDisableSharedMem -XX:+UseCondCardMark\"\r\nexport JAVA_OPTS=\"$JAVA_OPTS -XX:CMSWaitDuration=10000 -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:+CMSParallelRemarkEnabled -XX:+CMSParallelInitialMarkEnabled\"\r\nexport JAVA_OPTS=\"$JAVA_OPTS -XX:+CMSEdenChunksRecordAlways -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly\"\r\nexport JAVA_OPTS=\"$JAVA_OPTS -Xms256M -Xmx256M\"\r\nexport LOG_FILENAME=thingsboard.out\r\nexport LOADER_PATH=/usr/share/thingsboard/conf,/usr/share/thingsboard/extensions\r\nexport SQL_DATA_FOLDER=/usr/share/thingsboard/data/sql\r\n\r\n# DB Configuration\r\nexport DATABASE_ENTITIES_TYPE=sql\r\nexport DATABASE_TS_TYPE=sql\r\nexport SPRING_JPA_DATABASE_PLATFORM=org.hibernate.dialect.PostgreSQLDialect\r\nexport SPRING_DRIVER_CLASS_NAME=org.postgresql.Driver\r\nexport SPRING_DATASOURCE_URL=jdbc:postgresql://localhost:5432/thingsboard\r\nexport SPRING_DATASOURCE_USERNAME=postgres\r\nexport SPRING_DATASOURCE_PASSWORD=postgres\r\nexport SPRING_DATASOURCE_MAXIMUM_POOL_SIZE=5\r\nexport SQL_POSTGRES_TS_KV_PARTITIONING=MONTHS`\r\n\r\n\r\n\r\n\r\nUbuntu loaddemo Log:\r\nsudo /usr/share/thingsboard/bin/install/install.sh --loadDemo\r\n ===================================================\r\n :: ThingsBoard ::       (v3.1.1)\r\n ===================================================\r\n\r\nStarting ThingsBoard Installation...\r\nInstalling DataBase schema for entities...\r\nInstalling SQL DataBase schema part: schema-entities.sql\r\nUnexpected error during ThingsBoard installation!\r\norg.postgresql.util.PSQLException: ERROR: syntax error at or near \"PROCEDURE\"\r\n  Position: 21\r\n        at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2455)\r\n        at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2155)\r\n        at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:288)\r\n        at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:430)\r\n        at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:356)\r\n        at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:303)\r\n        at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:289)\r\n        at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:266)\r\n        at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:262)\r\n        at org.thingsboard.server.service.install.SqlAbstractDatabaseSchemaService.createDatabaseSchema(SqlAbstractDatabaseSchemaService.java:68)\r\n        at org.thingsboard.server.service.install.SqlAbstractDatabaseSchemaService.createDatabaseSchema(SqlAbstractDatabaseSchemaService.java:57)\r\n        at org.thingsboard.server.install.ThingsboardInstallService.performInstall(ThingsboardInstallService.java:194)\r\n        at org.thingsboard.server.ThingsboardInstallApplication.main(ThingsboardInstallApplication.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.springframework.boot.loader.MainMethodRunner.run(MainMethodRunner.java:48)\r\n        at org.springframework.boot.loader.Launcher.launch(Launcher.java:87)\r\n        at org.springframework.boot.loader.Launcher.launch(Launcher.java:51)\r\n        at org.springframework.boot.loader.PropertiesLauncher.main(PropertiesLauncher.java:597)\r\nUnexpected error during ThingsBoard installation!\r\nThingsBoard installation failed!"
      },
      {
        "user": "CooL16",
        "created_at": "2020-09-11T07:15:12Z",
        "body": "please upgrade PostgreSQL to 12+ version to resolve the issue"
      },
      {
        "user": "ravipras8",
        "created_at": "2020-09-11T07:42:58Z",
        "body": "@CooL16 i have followed the steps in the guide but checking version of postgres showing like below\r\n\r\nthingsboard$ psql -U postgres -d postgres -h 127.0.0.1 -W\r\nPassword:\r\npsql (12.4 (Ubuntu 12.4-1.pgdg16.04+1), server 9.5.23)\r\nSSL connection (protocol: TLSv1.2, cipher: ECDHE-RSA-AES256-GCM-SHA384, bits: 256, compression: off)\r\nType \"help\" for help.\r\n\r\npostgres= select version();\r\n                                                      version\r\n-------------------------------------------------------------------------------------------------------------------\r\n PostgreSQL 9.5.23 on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 5.4.0-6ubuntu1~16.04.12) 5.4.0 20160609, 64-bit\r\n"
      },
      {
        "user": "CooL16",
        "created_at": "2020-09-11T07:57:25Z",
        "body": "@ravipras8 your postgresql server has 9.5 version.\r\n\r\nPlease provide us with output of this command: pg_lsclusters"
      },
      {
        "user": "ravipras8",
        "created_at": "2020-09-11T08:03:17Z",
        "body": "pg_lsclusters\r\nVer Cluster Port Status Owner    Data directory               Log file\r\n9.5 main    5432 online postgres /var/lib/postgresql/9.5/main /var/log/postgresql/postgresql-9.5-main.log\r\n12  main    5433 online postgres /var/lib/postgresql/12/main  /var/log/postgresql/postgresql-12-main.log\r\n\r\n\r\nseems 2 versions installed.. removed both and installed 12 freshly its worked.\r\n\r\nthank you for your quick support."
      }
    ]
  },
  {
    "number": 3265,
    "title": "[Question] How to choose descending sort order in dashboard Device Admin Table widget's advanced form's Default sort order field",
    "created_at": "2020-08-09T19:16:15Z",
    "closed_at": "2020-08-11T20:31:27Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3265",
    "body": "**Component**\r\n\r\n<!-- Choose one of the following and delete all others. -->\r\n * UI\r\n\r\n\r\n**Description**\r\nI specified lastAcitivityTime in Dashboard->Widget->Device admin table->Advanced->Default sort order. That seems to be working. How can one specify descending order along with name? Default seems to be ascending and I have to click to choose descending every time I open the dashboard.\r\n\r\n**Environment**\r\n<!-- Add information about your environment and ThingsBoard version if applicable -->\r\n * OS:  Ubuntu LTS 18.04\r\n * ThingsBoard: 3.0.1\r\n * Browser: Chrome\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3265/comments",
    "author": "ashvarma-git",
    "comments": [
      {
        "user": "ChantsovaEkaterina",
        "created_at": "2020-08-10T07:11:31Z",
        "body": "Hello,\r\nYou can do this by adding the \" - \" sign before the attribute name specified as default sort order."
      }
    ]
  },
  {
    "number": 3184,
    "title": "[Question] DomSanitzer in Widget for base64 encoded data",
    "created_at": "2020-07-28T18:28:47Z",
    "closed_at": "2020-08-13T13:49:16Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3184",
    "body": "**Component**\r\n\r\n<!-- Choose one of the following and delete all others. -->\r\n * UI\r\n * Widget\r\n \r\n**Description**\r\nMy IoT application acquires audio signals from deployed devices. The short audio clips (<500KB) are base64 encoded and sent to TB as a JSON key/value. My goal is to provide access to the latest recordings on the dashboard so the user can quickly evaluate and take necessary action.\r\n\r\nSo I created a new widget to display the html5 audio element and set its src to the base64 encoded data string like this:`src=\"data:audio/wav;base64,UklGRgh3AQBXQVZFZm10IBAAAAAB \u2026 /6//q/+T/3P/g/9v/4//a/+j/3f/o/+X/6P/t//D/9v/3/w==\"`. However, Angular does not permit this because it is considered an unsafe url and disables it by prepending `unsafe` to the string like this: `src=\"unsafe:data:audio/wav;base64,UklGRgh3AQBXQVZFZm10IBAAAAAB \u2026 /6//q/+T/3P/g/9v/4//a/+j/3f/o/+X/6P/t//D/9v/3/w==\"`.\r\n\r\nThe obvious solution is to use Angular's DomSanitizer (`domSanitizer.bypassSecurityTrustUrl()`) but it is not accessible within the widget's scope and it cannot be imported at runtime. A search of this repo shows numerous usages of the DomSanitizer, including in various widget components (ui-ngx/src/app/modules/home/components/widget/lib/alarms-table-widget.component.ts, ui-ngx/src/app/modules/home/components/widget/lib/entities-table-widget.component.ts, ui-ngx/src/app/modules/home/components/widget/lib/timeseries-table-widget.component.ts, etc.). \r\n\r\nIs it possible to access the DomSanitizer in a Widget? If so, how? If not, what other options can I try?\r\n\r\n**Environment**\r\n<!-- Add information about your environment and ThingsBoard version if applicable -->\r\n * OS:  AWS EC2 \r\n * ThingsBoard: PE 3.0.1\r\n * Browser: Chrome 84\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3184/comments",
    "author": "imoon",
    "comments": [
      {
        "user": "vvlladd28",
        "created_at": "2020-08-11T20:19:22Z",
        "body": "Hi @imoon,\r\nIn the new version TB 3.1, we are added DomSanitizer to widgetContext. "
      }
    ]
  },
  {
    "number": 3147,
    "title": "How to pass entityName when using openDashBoardState() in custom Action",
    "created_at": "2020-07-23T21:47:03Z",
    "closed_at": "2020-07-25T19:50:44Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3147",
    "body": "Hi Guys, in the map widget we are using this following code to switch to dashboard state based on device type. But we cannot figure out how to pass entityName to the state so we can use the alias option 'Entity taken from dashboard state parameters'\r\n\r\nany help would be greatly appreciated \r\n\r\nversion: thingsboard 3.0.1PE\r\n\r\n```\r\n\r\nvar $injector = widgetContext.$scope.$injector;\r\n$injector.get(widgetContext.servicesMap.get('deviceService')).getDevice(entityId.id).subscribe(function(device) {\r\n        if (device.type == 'SCC-2D') {\r\n            openDashboardState('SCC_2D')\r\n        }\r\n        else if(device.type == 'SCC-2T') {\r\n            openDashboardState('SCC_2T')\r\n        }\r\n        else if(device.type == 'SCC-DT')  {\r\n            openDashboardState('SCC_DT')\r\n        }\r\n});\r\n\r\nfunction openDashboardState(stateId) {\r\n    var params = {\r\n        entityId: entityId,\r\n        entityName: entityName\r\n    }\r\n\r\n    widgetContext.stateController.openState(stateId, params, false);\r\n}\r\n\r\n```",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3147/comments",
    "author": "t0mZ4",
    "comments": [
      {
        "user": "vvlladd28",
        "created_at": "2020-07-24T21:15:47Z",
        "body": "Hi @t0mmyz7,\r\n\r\nYou need to use the name from the service response:\r\n \r\n```\r\nvar $injector = widgetContext.$scope.$injector;\r\nvar deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\r\n\r\ndeviceService.getDevice(entityId.id).subscribe(function(device) {\r\n        if (device.type == 'SCC-2D') {\r\n            openDashboardState(\u2018SCC_2D\u2019, device)\r\n        }\r\n        else if(device.type == 'SCC-2T') {\r\n            openDashboardState('SCC_2T', device)\r\n        }\r\n        else if(device.type == 'SCC-DT')  {\r\n            openDashboardState('SCC_DT', device)\r\n        }\r\n});\r\n\r\nfunction openDashboardState(stateId, device) {\r\n    var params = {\r\n        entityId: entityId,\r\n        entityName: device.name\r\n    }\r\n\r\n    widgetContext.stateController.openState(stateId, params, false);\r\n}\r\n```"
      },
      {
        "user": "Arteria2",
        "created_at": "2021-03-16T15:33:24Z",
        "body": "Hello, I try to put this code in custom Action but it does not work. Can you help me ?\r\nThanks\r\n\r\nvar $injector = widgetContext.$scope.$injector;\r\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\r\n\r\ndeviceService.getDevice(entityId.id).subscribe(function(device) {\r\n        if (device.type == 'ers-elsys') {\r\n            openDashboardState('co2_etat',device)\r\n        }\r\n        else if(device.type == 'ers-elsys-sound') {\r\n            openDashboardState('sound_etat',device)\r\n        }\r\n        \r\n});\r\n\r\nfunction openDashboardState(stateId,device) {\r\n    var params = {\r\n        entityId: entityId,\r\n        entityName: device.name\r\n    };\r\n\r\n    widgetContext.stateController.openState(stateId, params, false);\r\n}"
      }
    ]
  },
  {
    "number": 3017,
    "title": "[Question] How to exploit JSON Support in Widgets and Dashboards [2.5.2]",
    "created_at": "2020-06-28T23:42:46Z",
    "closed_at": "2020-07-03T06:42:42Z",
    "labels": [
      "question"
    ],
    "url": "https://github.com/thingsboard/thingsboard/issues/3017",
    "body": "The latest 2.5+ versions of TB support JSON in Telemetries & Attributes.\r\nHowever, there seems to be no added feature to access these datasets in the widgets Datasource section.\r\n\r\nI've tried dot notation with no luck, and I've also tried to use the Post-processing function to return sub-values of the JSON data, but the editor keeps demanding that the function must return a value.\r\n\r\nSample functions:\r\n\r\n    return value.key1; //Fails to compile\r\n    return value[\"key1\"]; //Fails\r\n    return JSON.parse(value).key1; //Also fails\r\n\r\nHow can we access inner fields in a JSON on the dashboards?\r\n",
    "comments_url": "https://api.github.com/repos/thingsboard/thingsboard/issues/3017/comments",
    "author": "Manusisko",
    "comments": [
      {
        "user": "ChantsovaEkaterina",
        "created_at": "2020-07-01T17:26:04Z",
        "body": "Hello,\r\nYou can try something like this:\r\n```\r\nvar temp = JSON.parse(value).key1;\r\nif (typeof temp !== 'undefined') {\r\n    value = temp;\r\n}\r\nreturn value;\r\n```"
      }
    ]
  }
]