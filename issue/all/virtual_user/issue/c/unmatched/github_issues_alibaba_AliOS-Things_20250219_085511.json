[
  {
    "number": 489,
    "title": "ESP8266\u7f16\u8bd1\u9519\u8bef",
    "created_at": "2018-08-16T15:05:14Z",
    "closed_at": "2018-08-17T08:22:09Z",
    "labels": [
      "help wanted"
    ],
    "url": "https://github.com/alibaba/AliOS-Things/issues/489",
    "body": "**Describe the bug**\r\nExecuting task: aos make helloworld@esp8266 <\r\n\r\naos-cube version: 0.2.50\r\nCheck if required tools for esp8266 exist\r\nMaking config file for first time\r\nprocessing components: helloworld esp8266 platform/mcu/esp8266 vcall init auto_component\r\napp_version:app-1.0.0-20180816.2301\r\nkernel_version:AOS-R-1.3.1\r\napp_version:app-1.0.0-20180816.2301\r\nkernel_version:AOS-R-1.3.1\r\nBuild AOS Now\r\nTOOLCHAIN_PATH=/Users/chenmeng/LoT/AliOS-Things/build/compiler/gcc-xtensa-lx106/OSX/bin/\r\nCompiling alicrypto\r\nCompiling auto_component\r\nCompiling cli\r\nCompiling board_esp8266\r\nCompiling framework\r\nCompiling hal\r\nCompiling helloworld\r\nCompiling kernel_init\r\nCompiling vfs_device\r\nCompiling newlib_stub\r\nCompiling log\r\nCompiling kv\r\nCompiling xtensa\r\nCompiling esp8266\r\nCompiling rhino\r\nCompiling vcall\r\nCompiling espos\r\nkernel/vcall/espos/platform/rhino/espos_queue.c: In function 'espos_queue_create':\r\nkernel/vcall/espos/platform/rhino/espos_queue.c:53:12: warning: assignment makes integer from pointer without a cast [enabled by default]\r\n     *queue = (espos_queue_t *)kqueue;\r\n            ^\r\nCompiling vfs\r\nCompiling yloop\r\nMaking out/helloworld@esp8266/ld/eagle.app.v6.new.1024.app1.ld\r\nMaking out/helloworld@esp8266/libraries/alicrypto.a\r\nMaking out/helloworld@esp8266/libraries/auto_component.a\r\nMaking out/helloworld@esp8266/libraries/cli.a\r\nMaking out/helloworld@esp8266/libraries/board_esp8266.a\r\nMaking out/helloworld@esp8266/libraries/framework.a\r\nMaking out/helloworld@esp8266/libraries/hal.a\r\nMaking out/helloworld@esp8266/libraries/helloworld.a\r\nMaking out/helloworld@esp8266/libraries/kernel_init.a\r\nMaking out/helloworld@esp8266/libraries/vfs_device.a\r\nMaking out/helloworld@esp8266/libraries/newlib_stub.a\r\nMaking out/helloworld@esp8266/libraries/log.a\r\nMaking out/helloworld@esp8266/libraries/kv.a\r\nMaking out/helloworld@esp8266/libraries/xtensa.a\r\nMaking out/helloworld@esp8266/libraries/esp8266.a\r\nMaking out/helloworld@esp8266/libraries/rhino.a\r\nMaking out/helloworld@esp8266/libraries/vcall.a\r\nMaking out/helloworld@esp8266/libraries/espos.a\r\nMaking out/helloworld@esp8266/libraries/vfs.a\r\nMaking out/helloworld@esp8266/libraries/yloop.a\r\nMaking helloworld@esp8266.elf\r\n\r\nMaking helloworld@esp8266.bin\r\nMaking helloworld@esp8266.hex\r\nno definite address hint,using default mem configuration\r\n\r\n                        AOS MEMORY MAP\r\n|=================================================================|\r\n| MODULE                                   | ROM       | RAM      |\r\n|=================================================================|\r\n| newlib_stub                              | 0         | 277      |\r\n| kv                                       | 0         | 3622     |\r\n| vcall                                    | 0         | 2686     |\r\n| kernel_init                              | 0         | 782      |\r\n| rhino                                    | 0         | 17957    |\r\n| framework                                | 0         | 382      |\r\n| vfs                                      | 0         | 3367     |\r\n| libgcc                                   | 0         | 1196     |\r\n| libmain                                  | 0         | 30187    |\r\n| libpp                                    | 0         | 62406    |\r\n| esp8266                                  | 0         | 9072     |\r\n| board_esp8266                            | 0         | 305      |\r\n| libcirom                                 | 0         | 29505    |\r\n| yloop                                    | 0         | 1396     |\r\n| libnet80211                              | 0         | 45787    |\r\n| xtensa                                   | 0         | 6863     |\r\n| libhal                                   | 0         | 37       |\r\n| log                                      | 0         | 533      |\r\n| espos                                    | 0         | 1138     |\r\n| helloworld                               | 0         | 236      |\r\n| cli                                      | 0         | 6612     |\r\n| hal                                      | 0         | 207      |\r\n| libwpa                                   | 0         | 17862    |\r\n| liblwip                                  | 0         | 39438    |\r\n| libcrypto                                | 0         | 14512    |\r\n| libphy                                   | 0         | 48619    |\r\n| *fill*                                   | 0         | 1604     |\r\n|=================================================================|\r\n| TOTAL (bytes)                            | 0         | 346588   |\r\n|=================================================================|\r\n/Users/xxxx/LoT/AliOS-Things/build/cmd/osx/dash: 1: python2: not found\r\nmv: eagle.app.flash.bin: No such file or directory\r\nBuild complete\r\nMaking .gdbinit\r\n\u6700\u540e\u65e0\u6cd5\u627e\u5230\u6587\u4ef6eagle.app.flash.bin\uff0c\u6700\u540ebinary\u6587\u4ef6\u5939\u4e0b\u6ca1\u6709\u6587\u4ef6xxxxx@esp8266-0x1000.bin\r\n**environment**\r\n1. branch(version):  \u6700\u65b0\u7248\u672c\r\n2. Desktop OS(windows linux or macOS): macOS\r\n3. example: \r\n\r\n**Expected behavior**\r\n\r\n\r\n**Screenshots**\r\n\r\n\r\n**Additional context**\r\n",
    "comments_url": "https://api.github.com/repos/alibaba/AliOS-Things/issues/489/comments",
    "author": "godchenmeng",
    "comments": [
      {
        "user": "librae8226",
        "created_at": "2018-08-17T06:25:35Z",
        "body": "\u8fd9\u91cc\u9762\u6709\u4e24\u4e2a\u95ee\u9898\uff1a\r\n1. Mac \u4e0b\u7684 python \u73af\u5883\u6ca1\u6709 python2 \u8fd9\u4e2a\u4e1c\u897f\uff0c\u5176\u5b9e\u5b83\u662f\u4e2a\u8f6f\u94fe\u63a5\u3002\r\n    \u89e3\u51b3\u65b9\u6cd5\uff1a\r\n    1) \u53ef\u4ee5\u76f4\u63a5\u628a\u5b83\u94fe\u63a5\u5230 python2.7\r\n    2) \u4fee\u6539 `platform/mcu/esp8266/gen_crc_bin.mk`: `python2` -> `python`\r\n2. \u4e0d\u4f1a\u751f\u6210 xxx@esp8266-0x1000.bin\r\n    \u89e3\u51b3\u65b9\u6cd5\uff1a\u4fee\u6539 `site_scons/scons_upload.py`\uff0c\u5982\u4e0b\r\n````\r\ndiff --git a/site_scons/scons_upload.py b/site_scons/scons_upload.py\r\nindex ec0511b80d..417db4c97e 100755\r\n--- a/site_scons/scons_upload.py\r\n+++ b/site_scons/scons_upload.py\r\n@@ -101,7 +101,7 @@ def upload_esp8266(target, aos_path):\r\n         error('Unsupported Operating System!')\r\n     cmd = 'esptool.py'\r\n     port = miniterm.ask_for_port()\r\n-    image_path = os.path.join(os.getcwd(), 'out', target, 'binary', target + '-0x1000.bin').replace('\\\\', '/')\r\n+    image_path = os.path.join(os.getcwd(), 'out', target, 'binary', target').replace('\\\\', '/')\r\n     boot_bin_path = os.path.join(aos_path, 'platform/mcu/esp8266/bsp/boot_v1.7_921600.bin').replace('\\\\', '/')\r\n     init_bin_path = os.path.join(aos_path, 'platform/mcu/esp8266/bsp/esp_init_data_default.bin').replace('\\\\', '/')\r\n     blank_bin_path = os.path.join(aos_path, 'platform/mcu/esp8266/bsp/blank.bin').replace('\\\\', '/')\r\n````"
      }
    ]
  }
]